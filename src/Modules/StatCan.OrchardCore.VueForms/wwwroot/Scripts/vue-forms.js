/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

// register VeeValidate components globally
Vue.component('validation-provider', VeeValidate.ValidationProvider);
Vue.component('validation-observer', VeeValidate.ValidationObserver); // include default english and french translations.

VeeValidate.localize({
  en: {
    "code": "en",
    "messages": {
      "alpha": "The {_field_} field may only contain alphabetic characters",
      "alpha_num": "The {_field_} field may only contain alpha-numeric characters",
      "alpha_dash": "The {_field_} field may contain alpha-numeric characters as well as dashes and underscores",
      "alpha_spaces": "The {_field_} field may only contain alphabetic characters as well as spaces",
      "between": "The {_field_} field must be between {min} and {max}",
      "confirmed": "The {_field_} field confirmation does not match",
      "digits": "The {_field_} field must be numeric and exactly contain {length} digits",
      "dimensions": "The {_field_} field must be {width} pixels by {height} pixels",
      "email": "The {_field_} field must be a valid email",
      "excluded": "The {_field_} field is not a valid value",
      "ext": "The {_field_} field is not a valid file",
      "image": "The {_field_} field must be an image",
      "integer": "The {_field_} field must be an integer",
      "length": "The {_field_} field must be {length} long",
      "max_value": "The {_field_} field must be {max} or less",
      "max": "The {_field_} field may not be greater than {length} characters",
      "mimes": "The {_field_} field must have a valid file type",
      "min_value": "The {_field_} field must be {min} or more",
      "min": "The {_field_} field must be at least {length} characters",
      "numeric": "The {_field_} field may only contain numeric characters",
      "oneOf": "The {_field_} field is not a valid value",
      "regex": "The {_field_} field format is invalid",
      "required_if": "The {_field_} field is required",
      "required": "The {_field_} field is required",
      "size": "The {_field_} field size must be less than {size}KB"
    }
  },
  fr: {
    "code": "fr",
    "messages": {
      "alpha": "Le champ {_field_} ne peut contenir que des lettres",
      "alpha_num": "Le champ {_field_} ne peut contenir que des caractères alpha-numériques",
      "alpha_dash": "Le champ {_field_} ne peut contenir que des caractères alpha-numériques, tirets ou soulignés",
      "alpha_spaces": "Le champ {_field_} ne peut contenir que des lettres ou des espaces",
      "between": "Le champ {_field_} doit être compris entre {min} et {max}",
      "confirmed": "Le champ {_field_} ne correspond pas",
      "digits": "Le champ {_field_} doit être un nombre entier de {length} chiffres",
      "dimensions": "Le champ {_field_} doit avoir une taille de {width} pixels par {height} pixels",
      "email": "Le champ {_field_} doit être une adresse e-mail valide",
      "excluded": "Le champ {_field_} doit être une valeur valide",
      "ext": "Le champ {_field_} doit être un fichier valide",
      "image": "Le champ {_field_} doit être une image",
      "integer": "Le champ {_field_} doit être un entier",
      "length": "Le champ {_field_} doit contenir {length} caractères",
      "max_value": "Le champ {_field_} doit avoir une valeur de {max} ou moins",
      "max": "Le champ {_field_} ne peut pas contenir plus de {length} caractères",
      "mimes": "Le champ {_field_} doit avoir un type MIME valide",
      "min_value": "Le champ {_field_} doit avoir une valeur de {min} ou plus",
      "min": "Le champ {_field_} doit contenir au minimum {length} caractères",
      "numeric": "Le champ {_field_} ne peut contenir que des chiffres",
      "oneOf": "Le champ {_field_} doit être une valeur valide",
      "regex": "Le champ {_field_} est invalide",
      "required": "Le champ {_field_} est obligatoire",
      "required_if": "Le champ {_field_} est obligatoire lorsque {target} possède cette valeur",
      "size": "Le champ {_field_} doit avoir un poids inférieur à {size}KB"
    }
  }
});
"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function decodeUnicode(str) {
  return decodeURIComponent(atob(str).split("").map(function (c) {
    return "%" + ("00" + c.charCodeAt(0).toString(16)).slice(-2);
  }).join(""));
} // run init script


function initForm(app) {
  // Set VeeValidate language based on the lang parameter
  VeeValidate.localize(app.dataset.lang);
  var componentOptions = app.dataset.options;
  var parsedOptions = {};

  if (componentOptions) {
    var fn = new Function("return (".concat(decodeUnicode(componentOptions), ");"));
    parsedOptions = fn();

    if (!parsedOptions) {
      console.log("Could not parse the componentOptions object. Make sure your object is well formed.");
    }
  }

  var _parsedOptions = parsedOptions,
      parsedData = _parsedOptions.data,
      parsedMethods = _parsedOptions.methods,
      parsedRest = _objectWithoutProperties(_parsedOptions, ["data", "methods"]);

  var objData = parsedData;

  if (typeof parsedData === "function") {
    objData = parsedData();
  }

  var defaultFormData = {
    submitting: false,
    submitSuccess: false,
    successMessage: undefined,
    submitError: false,
    submitValidationErrors: false,
    serverValidationMessage: undefined,
    serverErrorMessage: undefined,
    responseData: undefined
  };
  Vue.component(app.dataset.name, function (resolve) {
    resolve(_objectSpread(_objectSpread({}, parsedRest), {}, {
      template: "#".concat(app.dataset.name),
      data: function data() {
        return _objectSpread(_objectSpread({}, objData), {}, {
          form: _objectSpread({}, defaultFormData)
        });
      },
      methods: _objectSpread(_objectSpread({
        // default method that return the data to be submitted to the server
        // this was added first to allow the Administrator to edit this function on the OC Admin
        submitData: function submitData() {
          return _objectSpread({}, this.$data);
        }
      }, parsedMethods), {}, {
        formReset: function formReset() {
          this.form = _objectSpread({}, defaultFormData); // also reset the VeeValidate observer

          this.$refs.obs.reset();
        },
        formHandleSubmit: function formHandleSubmit(e) {
          e.preventDefault();
          var vm = this; // keep a reference to the VeeValidate observer

          var observer = vm.$refs.obs;
          observer.validate().then(function (valid) {
            if (valid) {
              var action = vm.$refs.form.getAttribute("action");
              var frmData = vm.submitData();
              frmData.__RequestVerificationToken = vm.$refs.form.querySelector('input[name="__RequestVerificationToken"]').value;

              if ((typeof grecaptcha === "undefined" ? "undefined" : _typeof(grecaptcha)) == "object") {
                frmData.recaptcha = grecaptcha.getResponse();
              }

              vm.form.submitting = true;
              $.ajax({
                type: "POST",
                url: action,
                data: frmData,
                cache: false,
                dataType: "json",
                success: function success(data) {
                  vm.form = _objectSpread({}, defaultFormData);
                  vm.form.responseData = data; // if there are validation errors on the form, display them.

                  if (data.validationError) {
                    //legacy
                    if (data.errors["serverValidationMessage"] != null) {
                      vm.form.serverValidationMessage = data.errors["serverValidationMessage"];
                    }

                    vm.form.submitValidationError = true;
                    observer.setErrors(data.errors);
                    return;
                  } // if the server sends a redirect, reload the window


                  if (data.redirect) {
                    window.location.href = data.redirect;
                    return;
                  }

                  vm.form.submitSuccess = true;
                  vm.form.successMessage = data.successMessage;
                  return;
                },
                error: function error(xhr, statusText) {
                  vm.form = _objectSpread({}, defaultFormData);
                  vm.form.submitError = true;
                  vm.form.serverErrorMessage = "".concat(xhr.status, " ").concat(statusText);
                }
              });
            }
          });
          return false;
        }
      })
    }));
  }); // run the vue-form init script provided in the OC admin ui

  var initScript = app.dataset.initScript;

  if (initScript) {
    var initFn = new Function(decodeUnicode(initScript));
    initFn();
  }
} // look for all vue forms when this script is loaded and initialize them


document.querySelectorAll(".vue-form").forEach(initForm);
document.addEventListener("DOMContentLoaded", function (event) {
  document.querySelectorAll(".vue-app-instance").forEach(function (elem) {
    new Vue({
      el: elem
    });
  });
  document.querySelectorAll(".vuetify-app-instance").forEach(function (elem) {
    new Vue({
      el: elem,
      vuetify: new Vuetify()
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlZXZhbGlkYXRlLXNldHVwLmpzIiwidnVlLWZvcm1zLmpzIl0sIm5hbWVzIjpbIlZ1ZSIsImNvbXBvbmVudCIsIlZlZVZhbGlkYXRlIiwiVmFsaWRhdGlvblByb3ZpZGVyIiwiVmFsaWRhdGlvbk9ic2VydmVyIiwibG9jYWxpemUiLCJlbiIsImZyIiwiZGVjb2RlVW5pY29kZSIsInN0ciIsImRlY29kZVVSSUNvbXBvbmVudCIsImF0b2IiLCJzcGxpdCIsIm1hcCIsImMiLCJjaGFyQ29kZUF0IiwidG9TdHJpbmciLCJzbGljZSIsImpvaW4iLCJpbml0Rm9ybSIsImFwcCIsImRhdGFzZXQiLCJsYW5nIiwiY29tcG9uZW50T3B0aW9ucyIsIm9wdGlvbnMiLCJwYXJzZWRPcHRpb25zIiwiZm4iLCJGdW5jdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJwYXJzZWREYXRhIiwiZGF0YSIsInBhcnNlZE1ldGhvZHMiLCJtZXRob2RzIiwicGFyc2VkUmVzdCIsIm9iakRhdGEiLCJkZWZhdWx0Rm9ybURhdGEiLCJzdWJtaXR0aW5nIiwic3VibWl0U3VjY2VzcyIsInN1Y2Nlc3NNZXNzYWdlIiwidW5kZWZpbmVkIiwic3VibWl0RXJyb3IiLCJzdWJtaXRWYWxpZGF0aW9uRXJyb3JzIiwic2VydmVyVmFsaWRhdGlvbk1lc3NhZ2UiLCJzZXJ2ZXJFcnJvck1lc3NhZ2UiLCJyZXNwb25zZURhdGEiLCJuYW1lIiwicmVzb2x2ZSIsInRlbXBsYXRlIiwiZm9ybSIsInN1Ym1pdERhdGEiLCIkZGF0YSIsImZvcm1SZXNldCIsIiRyZWZzIiwib2JzIiwicmVzZXQiLCJmb3JtSGFuZGxlU3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0Iiwidm0iLCJvYnNlcnZlciIsInZhbGlkYXRlIiwidGhlbiIsInZhbGlkIiwiYWN0aW9uIiwiZ2V0QXR0cmlidXRlIiwiZnJtRGF0YSIsIl9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuIiwicXVlcnlTZWxlY3RvciIsInZhbHVlIiwiZ3JlY2FwdGNoYSIsInJlY2FwdGNoYSIsImdldFJlc3BvbnNlIiwiJCIsImFqYXgiLCJ0eXBlIiwidXJsIiwiY2FjaGUiLCJkYXRhVHlwZSIsInN1Y2Nlc3MiLCJ2YWxpZGF0aW9uRXJyb3IiLCJlcnJvcnMiLCJzdWJtaXRWYWxpZGF0aW9uRXJyb3IiLCJzZXRFcnJvcnMiLCJyZWRpcmVjdCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsImVycm9yIiwieGhyIiwic3RhdHVzVGV4dCIsInN0YXR1cyIsImluaXRTY3JpcHQiLCJpbml0Rm4iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiZWxlbSIsImVsIiwidnVldGlmeSIsIlZ1ZXRpZnkiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0E7QUFDQUEsR0FBRyxDQUFDQyxTQUFKLENBQWMscUJBQWQsRUFBcUNDLFdBQVcsQ0FBQ0Msa0JBQWpEO0FBQ0FILEdBQUcsQ0FBQ0MsU0FBSixDQUFjLHFCQUFkLEVBQXFDQyxXQUFXLENBQUNFLGtCQUFqRCxFLENBRUE7O0FBQ0FGLFdBQVcsQ0FBQ0csUUFBWixDQUFxQjtBQUNuQkMsRUFBQUEsRUFBRSxFQUFDO0FBQ0QsWUFBUSxJQURQO0FBRUQsZ0JBQVk7QUFDVixlQUFTLDREQURDO0FBRVYsbUJBQWEsK0RBRkg7QUFHVixvQkFBYyw0RkFISjtBQUlWLHNCQUFnQiw4RUFKTjtBQUtWLGlCQUFXLHFEQUxEO0FBTVYsbUJBQWEsaURBTkg7QUFPVixnQkFBVSx5RUFQQTtBQVFWLG9CQUFjLCtEQVJKO0FBU1YsZUFBUywyQ0FUQztBQVVWLGtCQUFZLDBDQVZGO0FBV1YsYUFBTyx5Q0FYRztBQVlWLGVBQVMsc0NBWkM7QUFhVixpQkFBVyx3Q0FiRDtBQWNWLGdCQUFVLDJDQWRBO0FBZVYsbUJBQWEsMkNBZkg7QUFnQlYsYUFBTyxpRUFoQkc7QUFpQlYsZUFBUyxpREFqQkM7QUFrQlYsbUJBQWEsMkNBbEJIO0FBbUJWLGFBQU8sMERBbkJHO0FBb0JWLGlCQUFX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QStDQyxPQUEvQyxDQUF1RCxVQUFVRyxJQUFWLEVBQWdCO0FBQ3JFLFFBQUluRyxHQUFKLENBQVE7QUFDTm9HLE1BQUFBLEVBQUUsRUFBRUQ7QUFERSxLQUFSO0FBR0QsR0FKRDtBQUtBTCxFQUFBQSxRQUFRLENBQUNDLGdCQUFULENBQTBCLHVCQUExQixFQUFtREMsT0FBbkQsQ0FBMkQsVUFBVUcsSUFBVixFQUFnQjtBQUN6RSxRQUFJbkcsR0FBSixDQUFRO0FBQ05vRyxNQUFBQSxFQUFFLEVBQUVELElBREU7QUFFTkUsTUFBQUEsT0FBTyxFQUFFLElBQUlDLE9BQUo7QUFGSCxLQUFSO0FBSUQsR0FMRDtBQU1ELENBWkQiLCJmaWxlIjoidnVlLWZvcm1zLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbi8vIHJlZ2lzdGVyIFZlZVZhbGlkYXRlIGNvbXBvbmVudHMgZ2xvYmFsbHlcclxuVnVlLmNvbXBvbmVudCgndmFsaWRhdGlvbi1wcm92aWRlcicsIFZlZVZhbGlkYXRlLlZhbGlkYXRpb25Qcm92aWRlcik7XHJcblZ1ZS5jb21wb25lbnQoJ3ZhbGlkYXRpb24tb2JzZXJ2ZXInLCBWZWVWYWxpZGF0ZS5WYWxpZGF0aW9uT2JzZXJ2ZXIpOyBcclxuXHJcbi8vIGluY2x1ZGUgZGVmYXVsdCBlbmdsaXNoIGFuZCBmcmVuY2ggdHJhbnNsYXRpb25zLlxyXG5WZWVWYWxpZGF0ZS5sb2NhbGl6ZSh7XHJcbiAgZW46e1xyXG4gICAgXCJjb2RlXCI6IFwiZW5cIixcclxuICAgIFwibWVzc2FnZXNcIjoge1xyXG4gICAgICBcImFscGhhXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgb25seSBjb250YWluIGFscGhhYmV0aWMgY2hhcmFjdGVyc1wiLFxyXG4gICAgICBcImFscGhhX251bVwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbWF5IG9ubHkgY29udGFpbiBhbHBoYS1udW1lcmljIGNoYXJhY3RlcnNcIixcclxuICAgICAgXCJhbHBoYV9kYXNoXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgY29udGFpbiBhbHBoYS1udW1lcmljIGNoYXJhY3RlcnMgYXMgd2VsbCBhcyBkYXNoZXMgYW5kIHVuZGVyc2NvcmVzXCIsXHJcbiAgICAgIFwiYWxwaGFfc3BhY2VzXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgb25seSBjb250YWluIGFscGhhYmV0aWMgY2hhcmFjdGVycyBhcyB3ZWxsIGFzIHNwYWNlc1wiLFxyXG4gICAgICBcImJldHdlZW5cIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUgYmV0d2VlbiB7bWlufSBhbmQge21heH1cIixcclxuICAgICAgXCJjb25maXJtZWRcIjogXCJUaGUge19maWVsZF99IGZpZWxkIGNvbmZpcm1hdGlvbiBkb2VzIG5vdCBtYXRjaFwiLFxyXG4gICAgICBcImRpZ2l0c1wiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSBudW1lcmljIGFuZCBleGFjdGx5IGNvbnRhaW4ge2xlbmd0aH0gZGlnaXRzXCIsXHJcbiAgICAgIFwiZGltZW5zaW9uc1wiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSB7d2lkdGh9IHBpeGVscyBieSB7aGVpZ2h0fSBwaXhlbHNcIixcclxuICAgICAgXCJlbWFpbFwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSBhIHZhbGlkIGVtYWlsXCIsXHJcbiAgICAgIFwiZXhjbHVkZWRcIjogXCJUaGUge19maWVsZF99IGZpZWxkIGlzIG5vdCBhIHZhbGlkIHZhbHVlXCIsXHJcbiAgICAgIFwiZXh0XCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyBub3QgYSB2YWxpZCBmaWxlXCIsXHJcbiAgICAgIFwiaW1hZ2VcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUgYW4gaW1hZ2VcIixcclxuICAgICAgXCJpbnRlZ2VyXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtdXN0IGJlIGFuIGludGVnZXJcIixcclxuICAgICAgXCJsZW5ndGhcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUge2xlbmd0aH0gbG9uZ1wiLFxyXG4gICAgICBcIm1heF92YWx1ZVwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSB7bWF4fSBvciBsZXNzXCIsXHJcbiAgICAgIFwibWF4XCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgbm90IGJlIGdyZWF0ZXIgdGhhbiB7bGVuZ3RofSBjaGFyYWN0ZXJzXCIsXHJcbiAgICAgIFwibWltZXNcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgaGF2ZSBhIHZhbGlkIGZpbGUgdHlwZVwiLFxyXG4gICAgICBcIm1pbl92YWx1ZVwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSB7bWlufSBvciBtb3JlXCIsXHJcbiAgICAgIFwibWluXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtdXN0IGJlIGF0IGxlYXN0IHtsZW5ndGh9IGNoYXJhY3RlcnNcIixcclxuICAgICAgXCJudW1lcmljXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgb25seSBjb250YWluIG51bWVyaWMgY2hhcmFjdGVyc1wiLFxyXG4gICAgICBcIm9uZU9mXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyBub3QgYSB2YWxpZCB2YWx1ZVwiLFxyXG4gICAgICBcInJlZ2V4XCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBmb3JtYXQgaXMgaW52YWxpZFwiLFxyXG4gICAgICBcInJlcXVpcmVkX2lmXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyByZXF1aXJlZFwiLFxyXG4gICAgICBcInJlcXVpcmVkXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyByZXF1aXJlZFwiLFxyXG4gICAgICBcInNpemVcIjogXCJUaGUge19maWVsZF99IGZpZWxkIHNpemUgbXVzdCBiZSBsZXNzIHRoYW4ge3NpemV9S0JcIlxyXG4gICAgfVxyXG4gIH0sXHJcbiAgZnI6IHtcclxuICAgIFwiY29kZVwiOiBcImZyXCIsXHJcbiAgICBcIm1lc3NhZ2VzXCI6IHtcclxuICAgICAgXCJhbHBoYVwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBwZXV0IGNvbnRlbmlyIHF1ZSBkZXMgbGV0dHJlc1wiLFxyXG4gICAgICBcImFscGhhX251bVwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBwZXV0IGNvbnRlbmlyIHF1ZSBkZXMgY2FyYWN0w6hyZXMgYWxwaGEtbnVtw6lyaXF1ZXNcIixcclxuICAgICAgXCJhbHBoYV9kYXNoXCI6IFwiTGUgY2hhbXAge19maWVsZF99IG5lIHBldXQgY29udGVuaXIgcXVlIGRlcyBjYXJhY3TDqHJlcyBhbHBoYS1udW3DqXJpcXVlcywgdGlyZXRzIG91IHNvdWxpZ27DqXNcIixcclxuICAgICAgXCJhbHBoYV9zcGFjZXNcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gbmUgcGV1dCBjb250ZW5pciBxdWUgZGVzIGxldHRyZXMgb3UgZGVzIGVzcGFjZXNcIixcclxuICAgICAgXCJiZXR3ZWVuXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgw6p0cmUgY29tcHJpcyBlbnRyZSB7bWlufSBldCB7bWF4fVwiLFxyXG4gICAgICBcImNvbmZpcm1lZFwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBjb3JyZXNwb25kIHBhc1wiLFxyXG4gICAgICBcImRpZ2l0c1wiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IMOqdHJlIHVuIG5vbWJyZSBlbnRpZXIgZGUge2xlbmd0aH0gY2hpZmZyZXNcIixcclxuICAgICAgXCJkaW1lbnNpb25zXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgYXZvaXIgdW5lIHRhaWxsZSBkZSB7d2lkdGh9IHBpeGVscyBwYXIge2hlaWdodH0gcGl4ZWxzXCIsXHJcbiAgICAgIFwiZW1haWxcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1bmUgYWRyZXNzZSBlLW1haWwgdmFsaWRlXCIsXHJcbiAgICAgIFwiZXhjbHVkZWRcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1bmUgdmFsZXVyIHZhbGlkZVwiLFxyXG4gICAgICBcImV4dFwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IMOqdHJlIHVuIGZpY2hpZXIgdmFsaWRlXCIsXHJcbiAgICAgIFwiaW1hZ2VcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1bmUgaW1hZ2VcIixcclxuICAgICAgXCJpbnRlZ2VyXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgw6p0cmUgdW4gZW50aWVyXCIsXHJcbiAgICAgIFwibGVuZ3RoXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgY29udGVuaXIge2xlbmd0aH0gY2FyYWN0w6hyZXNcIixcclxuICAgICAgXCJtYXhfdmFsdWVcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCBhdm9pciB1bmUgdmFsZXVyIGRlIHttYXh9IG91IG1vaW5zXCIsXHJcbiAgICAgIFwibWF4XCI6IFwiTGUgY2hhbXAge19maWVsZF99IG5lIHBldXQgcGFzIGNvbnRlbmlyIHBsdXMgZGUge2xlbmd0aH0gY2FyYWN0w6hyZXNcIixcclxuICAgICAgXCJtaW1lc1wiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IGF2b2lyIHVuIHR5cGUgTUlNRSB2YWxpZGVcIixcclxuICAgICAgXCJtaW5fdmFsdWVcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCBhdm9pciB1bmUgdmFsZXVyIGRlIHttaW59IG91IHBsdXNcIixcclxuICAgICAgXCJtaW5cIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCBjb250ZW5pciBhdSBtaW5pbXVtIHtsZW5ndGh9IGNhcmFjdMOocmVzXCIsXHJcbiAgICAgIFwibnVtZXJpY1wiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBwZXV0IGNvbnRlbmlyIHF1ZSBkZXMgY2hpZmZyZXNcIixcclxuICAgICAgXCJvbmVPZlwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IMOqdHJlIHVuZSB2YWxldXIgdmFsaWRlXCIsXHJcbiAgICAgIFwicmVnZXhcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZXN0IGludmFsaWRlXCIsXHJcbiAgICAgIFwicmVxdWlyZWRcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZXN0IG9ibGlnYXRvaXJlXCIsXHJcbiAgICAgIFwicmVxdWlyZWRfaWZcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZXN0IG9ibGlnYXRvaXJlIGxvcnNxdWUge3RhcmdldH0gcG9zc8OoZGUgY2V0dGUgdmFsZXVyXCIsXHJcbiAgICAgIFwic2l6ZVwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IGF2b2lyIHVuIHBvaWRzIGluZsOpcmlldXIgw6Age3NpemV9S0JcIlxyXG4gICAgfVxyXG4gIH0sXHJcbn0pO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gZGVjb2RlVW5pY29kZShzdHIpIHtcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChcbiAgICBhdG9iKHN0cilcbiAgICAgIC5zcGxpdChcIlwiKVxuICAgICAgLm1hcChmdW5jdGlvbiAoYykge1xuICAgICAgICByZXR1cm4gXCIlXCIgKyAoXCIwMFwiICsgYy5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KSkuc2xpY2UoLTIpO1xuICAgICAgfSlcbiAgICAgIC5qb2luKFwiXCIpXG4gICk7XG59XG5cbi8vIHJ1biBpbml0IHNjcmlwdFxuZnVuY3Rpb24gaW5pdEZvcm0oYXBwKSB7XG4gIC8vIFNldCBWZWVWYWxpZGF0ZSBsYW5ndWFnZSBiYXNlZCBvbiB0aGUgbGFuZyBwYXJhbWV0ZXJcbiAgVmVlVmFsaWRhdGUubG9jYWxpemUoYXBwLmRhdGFzZXQubGFuZyk7XG5cbiAgbGV0IGNvbXBvbmVudE9wdGlvbnMgPSBhcHAuZGF0YXNldC5vcHRpb25zO1xuXG4gIGxldCBwYXJzZWRPcHRpb25zID0ge307XG4gIGlmIChjb21wb25lbnRPcHRpb25zKSB7XG4gICAgY29uc3QgZm4gPSBuZXcgRnVuY3Rpb24oYHJldHVybiAoJHtkZWNvZGVVbmljb2RlKGNvbXBvbmVudE9wdGlvbnMpfSk7YCk7XG4gICAgcGFyc2VkT3B0aW9ucyA9IGZuKCk7XG4gICAgaWYgKCFwYXJzZWRPcHRpb25zKSB7XG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgXCJDb3VsZCBub3QgcGFyc2UgdGhlIGNvbXBvbmVudE9wdGlvbnMgb2JqZWN0LiBNYWtlIHN1cmUgeW91ciBvYmplY3QgaXMgd2VsbCBmb3JtZWQuXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qge1xuICAgIGRhdGE6IHBhcnNlZERhdGEsXG4gICAgbWV0aG9kczogcGFyc2VkTWV0aG9kcyxcbiAgICAuLi5wYXJzZWRSZXN0XG4gIH0gPSBwYXJzZWRPcHRpb25zO1xuICBsZXQgb2JqRGF0YSA9IHBhcnNlZERhdGE7XG4gIGlmICh0eXBlb2YgcGFyc2VkRGF0YSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgb2JqRGF0YSA9IHBhcnNlZERhdGEoKTtcbiAgfVxuICBjb25zdCBkZWZhdWx0Rm9ybURhdGEgPSB7XG4gICAgc3VibWl0dGluZzogZmFsc2UsXG4gICAgc3VibWl0U3VjY2VzczogZmFsc2UsXG4gICAgc3VjY2Vzc01lc3NhZ2U6IHVuZGVmaW5lZCxcbiAgICBzdWJtaXRFcnJvcjogZmFsc2UsXG4gICAgc3VibWl0VmFsaWRhdGlvbkVycm9yczogZmFsc2UsXG4gICAgc2VydmVyVmFsaWRhdGlvbk1lc3NhZ2U6IHVuZGVmaW5lZCxcbiAgICBzZXJ2ZXJFcnJvck1lc3NhZ2U6IHVuZGVmaW5lZCxcbiAgICByZXNwb25zZURhdGE6IHVuZGVmaW5lZCxcbiAgfTtcblxuICBWdWUuY29tcG9uZW50KGFwcC5kYXRhc2V0Lm5hbWUsIGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgcmVzb2x2ZSh7XG4gICAgICAvLyBGaXJzdCBiZWNhdXNlIHRoZSBlbGVtZW50cyBiZWxvdyB3aWxsIG92ZXJyaWRlXG4gICAgICAuLi5wYXJzZWRSZXN0LFxuICAgICAgdGVtcGxhdGU6IGAjJHthcHAuZGF0YXNldC5uYW1lfWAsXG4gICAgICBkYXRhOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ub2JqRGF0YSxcbiAgICAgICAgICBmb3JtOiB7IC4uLmRlZmF1bHRGb3JtRGF0YSB9LFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICAgIG1ldGhvZHM6IHtcbiAgICAgICAgLy8gZGVmYXVsdCBtZXRob2QgdGhhdCByZXR1cm4gdGhlIGRhdGEgdG8gYmUgc3VibWl0dGVkIHRvIHRoZSBzZXJ2ZXJcbiAgICAgICAgLy8gdGhpcyB3YXMgYWRkZWQgZmlyc3QgdG8gYWxsb3cgdGhlIEFkbWluaXN0cmF0b3IgdG8gZWRpdCB0aGlzIGZ1bmN0aW9uIG9uIHRoZSBPQyBBZG1pblxuICAgICAgICBzdWJtaXREYXRhKCkge1xuICAgICAgICAgIHJldHVybiB7IC4uLnRoaXMuJGRhdGEgfTtcbiAgICAgICAgfSxcbiAgICAgICAgLi4ucGFyc2VkTWV0aG9kcyxcbiAgICAgICAgZm9ybVJlc2V0KCkge1xuICAgICAgICAgIHRoaXMuZm9ybSA9IHsgLi4uZGVmYXVsdEZvcm1EYXRhIH07XG4gICAgICAgICAgLy8gYWxzbyByZXNldCB0aGUgVmVlVmFsaWRhdGUgb2JzZXJ2ZXJcbiAgICAgICAgICB0aGlzLiRyZWZzLm9icy5yZXNldCgpO1xuICAgICAgICB9LFxuICAgICAgICBmb3JtSGFuZGxlU3VibWl0KGUpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgY29uc3Qgdm0gPSB0aGlzO1xuICAgICAgICAgIC8vIGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlIFZlZVZhbGlkYXRlIG9ic2VydmVyXG4gICAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSB2bS4kcmVmcy5vYnM7XG4gICAgICAgICAgb2JzZXJ2ZXIudmFsaWRhdGUoKS50aGVuKCh2YWxpZCkgPT4ge1xuICAgICAgICAgICAgaWYgKHZhbGlkKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IHZtLiRyZWZzLmZvcm0uZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpO1xuICAgICAgICAgICAgICBsZXQgZnJtRGF0YSA9IHZtLnN1Ym1pdERhdGEoKTtcbiAgICAgICAgICAgICAgZnJtRGF0YS5fX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbiA9IHZtLiRyZWZzLmZvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICAnaW5wdXRbbmFtZT1cIl9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuXCJdJ1xuICAgICAgICAgICAgICApLnZhbHVlO1xuICAgICAgICAgICAgICBpZiAodHlwZW9mIGdyZWNhcHRjaGEgPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIGZybURhdGEucmVjYXB0Y2hhID0gZ3JlY2FwdGNoYS5nZXRSZXNwb25zZSgpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdm0uZm9ybS5zdWJtaXR0aW5nID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICAgIHVybDogYWN0aW9uLFxuICAgICAgICAgICAgICAgIGRhdGE6IGZybURhdGEsXG4gICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgICAgdm0uZm9ybSA9IHsgLi4uZGVmYXVsdEZvcm1EYXRhIH07XG4gICAgICAgICAgICAgICAgICB2bS5mb3JtLnJlc3BvbnNlRGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSBhcmUgdmFsaWRhdGlvbiBlcnJvcnMgb24gdGhlIGZvcm0sIGRpc3BsYXkgdGhlbS5cbiAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnZhbGlkYXRpb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAvL2xlZ2FjeVxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5lcnJvcnNbXCJzZXJ2ZXJWYWxpZGF0aW9uTWVzc2FnZVwiXSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdm0uZm9ybS5zZXJ2ZXJWYWxpZGF0aW9uTWVzc2FnZSA9XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmVycm9yc1tcInNlcnZlclZhbGlkYXRpb25NZXNzYWdlXCJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZtLmZvcm0uc3VibWl0VmFsaWRhdGlvbkVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuc2V0RXJyb3JzKGRhdGEuZXJyb3JzKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgc2VydmVyIHNlbmRzIGEgcmVkaXJlY3QsIHJlbG9hZCB0aGUgd2luZG93XG4gICAgICAgICAgICAgICAgICBpZiAoZGF0YS5yZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGRhdGEucmVkaXJlY3Q7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgdm0uZm9ybS5zdWJtaXRTdWNjZXNzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgIHZtLmZvcm0uc3VjY2Vzc01lc3NhZ2UgPSBkYXRhLnN1Y2Nlc3NNZXNzYWdlO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHN0YXR1c1RleHQpIHtcbiAgICAgICAgICAgICAgICAgIHZtLmZvcm0gPSB7IC4uLmRlZmF1bHRGb3JtRGF0YSB9O1xuICAgICAgICAgICAgICAgICAgdm0uZm9ybS5zdWJtaXRFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICB2bS5mb3JtLnNlcnZlckVycm9yTWVzc2FnZSA9IGAke3hoci5zdGF0dXN9ICR7c3RhdHVzVGV4dH1gO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0pO1xuXG4gIC8vIHJ1biB0aGUgdnVlLWZvcm0gaW5pdCBzY3JpcHQgcHJvdmlkZWQgaW4gdGhlIE9DIGFkbWluIHVpXG4gIGxldCBpbml0U2NyaXB0ID0gYXBwLmRhdGFzZXQuaW5pdFNjcmlwdDtcbiAgaWYgKGluaXRTY3JpcHQpIHtcbiAgICBjb25zdCBpbml0Rm4gPSBuZXcgRnVuY3Rpb24oZGVjb2RlVW5pY29kZShpbml0U2NyaXB0KSk7XG4gICAgaW5pdEZuKCk7XG4gIH1cbn1cblxuLy8gbG9vayBmb3IgYWxsIHZ1ZSBmb3JtcyB3aGVuIHRoaXMgc2NyaXB0IGlzIGxvYWRlZCBhbmQgaW5pdGlhbGl6ZSB0aGVtXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnZ1ZS1mb3JtXCIpLmZvckVhY2goaW5pdEZvcm0pO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi52dWUtYXBwLWluc3RhbmNlXCIpLmZvckVhY2goZnVuY3Rpb24gKGVsZW0pIHtcbiAgICBuZXcgVnVlKHtcbiAgICAgIGVsOiBlbGVtLFxuICAgIH0pO1xuICB9KTtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi52dWV0aWZ5LWFwcC1pbnN0YW5jZVwiKS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtKSB7XG4gICAgbmV3IFZ1ZSh7XG4gICAgICBlbDogZWxlbSxcbiAgICAgIHZ1ZXRpZnk6IG5ldyBWdWV0aWZ5KCksXG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXX0=
