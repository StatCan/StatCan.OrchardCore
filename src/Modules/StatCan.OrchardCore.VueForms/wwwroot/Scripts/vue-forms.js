/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

// register VeeValidate components globally
Vue.component('validation-provider', VeeValidate.ValidationProvider);
Vue.component('validation-observer', VeeValidate.ValidationObserver); // include default english and french translations.

VeeValidate.localize({
  en: {
    "code": "en",
    "messages": {
      "alpha": "The {_field_} field may only contain alphabetic characters",
      "alpha_num": "The {_field_} field may only contain alpha-numeric characters",
      "alpha_dash": "The {_field_} field may contain alpha-numeric characters as well as dashes and underscores",
      "alpha_spaces": "The {_field_} field may only contain alphabetic characters as well as spaces",
      "between": "The {_field_} field must be between {min} and {max}",
      "confirmed": "The {_field_} field confirmation does not match",
      "digits": "The {_field_} field must be numeric and exactly contain {length} digits",
      "dimensions": "The {_field_} field must be {width} pixels by {height} pixels",
      "email": "The {_field_} field must be a valid email",
      "excluded": "The {_field_} field is not a valid value",
      "ext": "The {_field_} field is not a valid file",
      "image": "The {_field_} field must be an image",
      "integer": "The {_field_} field must be an integer",
      "length": "The {_field_} field must be {length} long",
      "max_value": "The {_field_} field must be {max} or less",
      "max": "The {_field_} field may not be greater than {length} characters",
      "mimes": "The {_field_} field must have a valid file type",
      "min_value": "The {_field_} field must be {min} or more",
      "min": "The {_field_} field must be at least {length} characters",
      "numeric": "The {_field_} field may only contain numeric characters",
      "oneOf": "The {_field_} field is not a valid value",
      "regex": "The {_field_} field format is invalid",
      "required_if": "The {_field_} field is required",
      "required": "The {_field_} field is required",
      "size": "The {_field_} field size must be less than {size}KB"
    }
  },
  fr: {
    "code": "fr",
    "messages": {
      "alpha": "Le champ {_field_} ne peut contenir que des lettres",
      "alpha_num": "Le champ {_field_} ne peut contenir que des caractères alpha-numériques",
      "alpha_dash": "Le champ {_field_} ne peut contenir que des caractères alpha-numériques, tirets ou soulignés",
      "alpha_spaces": "Le champ {_field_} ne peut contenir que des lettres ou des espaces",
      "between": "Le champ {_field_} doit être compris entre {min} et {max}",
      "confirmed": "Le champ {_field_} ne correspond pas",
      "digits": "Le champ {_field_} doit être un nombre entier de {length} chiffres",
      "dimensions": "Le champ {_field_} doit avoir une taille de {width} pixels par {height} pixels",
      "email": "Le champ {_field_} doit être une adresse e-mail valide",
      "excluded": "Le champ {_field_} doit être une valeur valide",
      "ext": "Le champ {_field_} doit être un fichier valide",
      "image": "Le champ {_field_} doit être une image",
      "integer": "Le champ {_field_} doit être un entier",
      "length": "Le champ {_field_} doit contenir {length} caractères",
      "max_value": "Le champ {_field_} doit avoir une valeur de {max} ou moins",
      "max": "Le champ {_field_} ne peut pas contenir plus de {length} caractères",
      "mimes": "Le champ {_field_} doit avoir un type MIME valide",
      "min_value": "Le champ {_field_} doit avoir une valeur de {min} ou plus",
      "min": "Le champ {_field_} doit contenir au minimum {length} caractères",
      "numeric": "Le champ {_field_} ne peut contenir que des chiffres",
      "oneOf": "Le champ {_field_} doit être une valeur valide",
      "regex": "Le champ {_field_} est invalide",
      "required": "Le champ {_field_} est obligatoire",
      "required_if": "Le champ {_field_} est obligatoire lorsque {target} possède cette valeur",
      "size": "Le champ {_field_} doit avoir un poids inférieur à {size}KB"
    }
  }
});
"use strict";

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function decodeUnicode(str) {
  // Going backwards: from bytestream, to percent-encoding, to original string.
  return decodeURIComponent(atob(str).split('').map(function (c) {
    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
  }).join(''));
} // run init script


function initForm(app) {
  // Set VeeValidate language based on the lang parameter
  VeeValidate.localize(app.dataset.lang);
  var componentOptions = app.dataset.options;
  var parsedOptions = {};

  if (componentOptions) {
    var fn = new Function("return ".concat(decodeUnicode(componentOptions), ";"));
    parsedOptions = fn();
  }

  var _parsedOptions = parsedOptions,
      parsedData = _parsedOptions.data,
      parsedMethods = _parsedOptions.methods,
      parsedRest = _objectWithoutProperties(_parsedOptions, ["data", "methods"]);

  var objData = parsedData;

  if (typeof parsedData === "function") {
    objData = parsedData();
  }

  var defaultFormData = {
    submitting: false,
    submitSuccess: false,
    successMessage: undefined,
    submitError: false,
    submitValidationErrors: false,
    serverValidationMessage: undefined,
    serverErrorMessage: undefined
  }; //todo component name

  Vue.component(app.dataset.name, _objectSpread(_objectSpread({}, parsedRest), {}, {
    template: "#".concat(app.dataset.name),
    data: function data() {
      return _objectSpread(_objectSpread({}, objData), {}, {
        form: _objectSpread({}, defaultFormData)
      });
    },
    methods: _objectSpread(_objectSpread({}, parsedMethods), {}, {
      formReset: function formReset() {
        this.form = _objectSpread({}, defaultFormData); // also reset the VeeValidate observer

        this.$refs.obs.reset();
      },
      formHandleSubmit: function formHandleSubmit(e) {
        e.preventDefault();
        var vm = this; // keep a reference to the VeeValidate observer

        var observer = vm.$refs.obs;
        observer.validate().then(function (valid) {
          if (valid) {
            var action = vm.$refs.form.getAttribute("action");
            var token = vm.$refs.form.querySelector('input[name="__RequestVerificationToken"]');
            ;
            vm.form.submitting = true;
            $.ajax({
              type: "POST",
              url: action,
              data: _objectSpread(_objectSpread({}, vm.$data), {}, {
                __RequestVerificationToken: token.value
              }),
              cache: false,
              dataType: "json",
              success: function success(data) {
                vm.form = _objectSpread({}, defaultFormData); // if there are validation errors on the form, display them.

                if (data.validationError) {
                  // special key for serverErrorMessages
                  if (data.errors['serverValidationMessage'] != null) {
                    vm.form.serverValidationMessage = data.errors['serverValidationMessage'];
                  }

                  vm.form.submitValidationError = true;
                  observer.setErrors(data.errors);
                  return;
                } // if the server sends a redirect, reload the window


                if (data.redirect) {
                  window.location.href = data.redirect;
                  return;
                } //success, set the form success message 


                if (data.success) {
                  vm.form.submitSuccess = true;
                  vm.form.successMessage = data.successMessage;
                  return;
                }

                vm.form.submitError = true; // something went wrong, dev issue

                vm.form.serverErrorMessage = "Something wen't wrong. Please report this to your site administrators. Error code: `VueForms.AjaxHandler`";
              },
              error: function error(xhr, statusText) {
                vm.form = _objectSpread({}, defaultFormData);
                vm.form.submitError = true;
                vm.form.serverErrorMessage = "".concat(xhr.status, " ").concat(statusText);
              }
            });
          }
        });
        return false;
      }
    })
  })); // run the vue-form init script provided in the OC admin ui

  var initScript = app.dataset.initScript;

  if (initScript) {
    var initFn = new Function(decodeUnicode(initScript));
    initFn();
  }
} // look for all vue forms when this script is loaded and initialize them


document.querySelectorAll(".vue-form").forEach(initForm);
var formLoadedEvent = new Event('vue-form-component-loaded');
document.dispatchEvent(formLoadedEvent);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlZXZhbGlkYXRlLXNldHVwLmpzIiwidnVlLWZvcm1zLmpzIl0sIm5hbWVzIjpbIlZ1ZSIsImNvbXBvbmVudCIsIlZlZVZhbGlkYXRlIiwiVmFsaWRhdGlvblByb3ZpZGVyIiwiVmFsaWRhdGlvbk9ic2VydmVyIiwibG9jYWxpemUiLCJlbiIsImZyIiwiZGVjb2RlVW5pY29kZSIsInN0ciIsImRlY29kZVVSSUNvbXBvbmVudCIsImF0b2IiLCJzcGxpdCIsIm1hcCIsImMiLCJjaGFyQ29kZUF0IiwidG9TdHJpbmciLCJzbGljZSIsImpvaW4iLCJpbml0Rm9ybSIsImFwcCIsImRhdGFzZXQiLCJsYW5nIiwiY29tcG9uZW50T3B0aW9ucyIsIm9wdGlvbnMiLCJwYXJzZWRPcHRpb25zIiwiZm4iLCJGdW5jdGlvbiIsInBhcnNlZERhdGEiLCJkYXRhIiwicGFyc2VkTWV0aG9kcyIsIm1ldGhvZHMiLCJwYXJzZWRSZXN0Iiwib2JqRGF0YSIsImRlZmF1bHRGb3JtRGF0YSIsInN1Ym1pdHRpbmciLCJzdWJtaXRTdWNjZXNzIiwic3VjY2Vzc01lc3NhZ2UiLCJ1bmRlZmluZWQiLCJzdWJtaXRFcnJvciIsInN1Ym1pdFZhbGlkYXRpb25FcnJvcnMiLCJzZXJ2ZXJWYWxpZGF0aW9uTWVzc2FnZSIsInNlcnZlckVycm9yTWVzc2FnZSIsIm5hbWUiLCJ0ZW1wbGF0ZSIsImZvcm0iLCJmb3JtUmVzZXQiLCIkcmVmcyIsIm9icyIsInJlc2V0IiwiZm9ybUhhbmRsZVN1Ym1pdCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInZtIiwib2JzZXJ2ZXIiLCJ2YWxpZGF0ZSIsInRoZW4iLCJ2YWxpZCIsImFjdGlvbiIsImdldEF0dHJpYnV0ZSIsInRva2VuIiwicXVlcnlTZWxlY3RvciIsIiQiLCJhamF4IiwidHlwZSIsInVybCIsIiRkYXRhIiwiX19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4iLCJ2YWx1ZSIsImNhY2hlIiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwidmFsaWRhdGlvbkVycm9yIiwiZXJyb3JzIiwic3VibWl0VmFsaWRhdGlvbkVycm9yIiwic2V0RXJyb3JzIiwicmVkaXJlY3QiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJlcnJvciIsInhociIsInN0YXR1c1RleHQiLCJzdGF0dXMiLCJpbml0U2NyaXB0IiwiaW5pdEZuIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImZvcm1Mb2FkZWRFdmVudCIsIkV2ZW50IiwiZGlzcGF0Y2hFdmVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQTtBQUNBQSxHQUFHLENBQUNDLFNBQUosQ0FBYyxxQkFBZCxFQUFxQ0MsV0FBVyxDQUFDQyxrQkFBakQ7QUFDQUgsR0FBRyxDQUFDQyxTQUFKLENBQWMscUJBQWQsRUFBcUNDLFdBQVcsQ0FBQ0Usa0JBQWpELEUsQ0FFQTs7QUFDQUYsV0FBVyxDQUFDRyxRQUFaLENBQXFCO0FBQ25CQyxFQUFBQSxFQUFFLEVBQUM7QUFDRCxZQUFRLElBRFA7QUFFRCxnQkFBWTtBQUNWLGVBQVMsNERBREM7QUFFVixtQkFBYSwrREFGSDtBQUdWLG9CQUFjLDRGQUhKO0FBSVYsc0JBQWdCLDhFQUpOO0FBS1YsaUJBQVcscURBTEQ7QUFNVixtQkFBYSxpREFOSDtBQU9WLGdCQUFVLHlFQVBBO0FBUVYsb0JBQWMsK0RBUko7QUFTVixlQUFTLDJDQVRDO0FBVVYsa0JBQVksMENBVkY7QUFXVixhQUFPLHlDQVhHO0FBWVYsZUFBUyxzQ0FaQztBQWFWLGlCQUFXLHdDQWJEO0FBY1YsZ0JBQVUsMkNBZEE7QUFlVixtQkFBYSwyQ0FmSDtBQWdCVixhQUFPLGlFQWhCRztBQWlCVixlQUFTLGlEQWpCQztBQWtCVixtQkFBYSwyQ0FsQkg7QUFtQlYsYUFBTywwREFuQkc7QUFvQlYsaUJBQVcseURBcEJEO0FBcUJWLGVBQVMsMENBckJDO0FBc0JWLGVBQVMsdUNBdEJDO0FBdUJWLHFCQUFlLGlDQXZCTDtBQXdCVixrQkFBWSxpQ0F4QkY7QUF5QlYsY0FBUTtBQXpCRTtBQUZYLEdBRGdCO0FB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cUJBQWNYLGVBQWQ7QUFDQW1CLGdCQUFBQSxFQUFFLENBQUNSLElBQUgsQ0FBUU4sV0FBUixHQUFzQixJQUF0QjtBQUNBYyxnQkFBQUEsRUFBRSxDQUFDUixJQUFILENBQVFILGtCQUFSLGFBQWdDdUMsR0FBRyxDQUFDRSxNQUFwQyxjQUE4Q0QsVUFBOUM7QUFDRDtBQXhDSSxhQUFQO0FBMENEO0FBQ0YsU0FqREQ7QUFrREEsZUFBTyxLQUFQO0FBQ0Q7QUEvREk7QUFWVCxNQTlCcUIsQ0EyR3JCOztBQUNBLE1BQUlFLFVBQVUsR0FBR2hFLEdBQUcsQ0FBQ0MsT0FBSixDQUFZK0QsVUFBN0I7O0FBQ0EsTUFBSUEsVUFBSixFQUFnQjtBQUNkLFFBQU1DLE1BQU0sR0FBRyxJQUFJMUQsUUFBSixDQUFhbkIsYUFBYSxDQUFDNEUsVUFBRCxDQUExQixDQUFmO0FBQ0FDLElBQUFBLE1BQU07QUFDUDtBQUNGLEMsQ0FHRDs7O0FBQ0FDLFFBQVEsQ0FBQ0MsZ0JBQVQsQ0FBMEIsV0FBMUIsRUFBdUNDLE9BQXZDLENBQStDckUsUUFBL0M7QUFDQSxJQUFNc0UsZUFBZSxHQUFHLElBQUlDLEtBQUosQ0FBVSwyQkFBVixDQUF4QjtBQUNBSixRQUFRLENBQUNLLGFBQVQsQ0FBdUJGLGVBQXZCIiwiZmlsZSI6InZ1ZS1mb3Jtcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4vLyByZWdpc3RlciBWZWVWYWxpZGF0ZSBjb21wb25lbnRzIGdsb2JhbGx5XHJcblZ1ZS5jb21wb25lbnQoJ3ZhbGlkYXRpb24tcHJvdmlkZXInLCBWZWVWYWxpZGF0ZS5WYWxpZGF0aW9uUHJvdmlkZXIpO1xyXG5WdWUuY29tcG9uZW50KCd2YWxpZGF0aW9uLW9ic2VydmVyJywgVmVlVmFsaWRhdGUuVmFsaWRhdGlvbk9ic2VydmVyKTsgXHJcblxyXG4vLyBpbmNsdWRlIGRlZmF1bHQgZW5nbGlzaCBhbmQgZnJlbmNoIHRyYW5zbGF0aW9ucy5cclxuVmVlVmFsaWRhdGUubG9jYWxpemUoe1xyXG4gIGVuOntcclxuICAgIFwiY29kZVwiOiBcImVuXCIsXHJcbiAgICBcIm1lc3NhZ2VzXCI6IHtcclxuICAgICAgXCJhbHBoYVwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbWF5IG9ubHkgY29udGFpbiBhbHBoYWJldGljIGNoYXJhY3RlcnNcIixcclxuICAgICAgXCJhbHBoYV9udW1cIjogXCJUaGUge19maWVsZF99IGZpZWxkIG1heSBvbmx5IGNvbnRhaW4gYWxwaGEtbnVtZXJpYyBjaGFyYWN0ZXJzXCIsXHJcbiAgICAgIFwiYWxwaGFfZGFzaFwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbWF5IGNvbnRhaW4gYWxwaGEtbnVtZXJpYyBjaGFyYWN0ZXJzIGFzIHdlbGwgYXMgZGFzaGVzIGFuZCB1bmRlcnNjb3Jlc1wiLFxyXG4gICAgICBcImFscGhhX3NwYWNlc1wiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbWF5IG9ubHkgY29udGFpbiBhbHBoYWJldGljIGNoYXJhY3RlcnMgYXMgd2VsbCBhcyBzcGFjZXNcIixcclxuICAgICAgXCJiZXR3ZWVuXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtdXN0IGJlIGJldHdlZW4ge21pbn0gYW5kIHttYXh9XCIsXHJcbiAgICAgIFwiY29uZmlybWVkXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBjb25maXJtYXRpb24gZG9lcyBub3QgbWF0Y2hcIixcclxuICAgICAgXCJkaWdpdHNcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUgbnVtZXJpYyBhbmQgZXhhY3RseSBjb250YWluIHtsZW5ndGh9IGRpZ2l0c1wiLFxyXG4gICAgICBcImRpbWVuc2lvbnNcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUge3dpZHRofSBwaXhlbHMgYnkge2hlaWdodH0gcGl4ZWxzXCIsXHJcbiAgICAgIFwiZW1haWxcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUgYSB2YWxpZCBlbWFpbFwiLFxyXG4gICAgICBcImV4Y2x1ZGVkXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyBub3QgYSB2YWxpZCB2YWx1ZVwiLFxyXG4gICAgICBcImV4dFwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgaXMgbm90IGEgdmFsaWQgZmlsZVwiLFxyXG4gICAgICBcImltYWdlXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtdXN0IGJlIGFuIGltYWdlXCIsXHJcbiAgICAgIFwiaW50ZWdlclwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSBhbiBpbnRlZ2VyXCIsXHJcbiAgICAgIFwibGVuZ3RoXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtdXN0IGJlIHtsZW5ndGh9IGxvbmdcIixcclxuICAgICAgXCJtYXhfdmFsdWVcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUge21heH0gb3IgbGVzc1wiLFxyXG4gICAgICBcIm1heFwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbWF5IG5vdCBiZSBncmVhdGVyIHRoYW4ge2xlbmd0aH0gY2hhcmFjdGVyc1wiLFxyXG4gICAgICBcIm1pbWVzXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtdXN0IGhhdmUgYSB2YWxpZCBmaWxlIHR5cGVcIixcclxuICAgICAgXCJtaW5fdmFsdWVcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUge21pbn0gb3IgbW9yZVwiLFxyXG4gICAgICBcIm1pblwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSBhdCBsZWFzdCB7bGVuZ3RofSBjaGFyYWN0ZXJzXCIsXHJcbiAgICAgIFwibnVtZXJpY1wiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbWF5IG9ubHkgY29udGFpbiBudW1lcmljIGNoYXJhY3RlcnNcIixcclxuICAgICAgXCJvbmVPZlwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgaXMgbm90IGEgdmFsaWQgdmFsdWVcIixcclxuICAgICAgXCJyZWdleFwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgZm9ybWF0IGlzIGludmFsaWRcIixcclxuICAgICAgXCJyZXF1aXJlZF9pZlwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgaXMgcmVxdWlyZWRcIixcclxuICAgICAgXCJyZXF1aXJlZFwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgaXMgcmVxdWlyZWRcIixcclxuICAgICAgXCJzaXplXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBzaXplIG11c3QgYmUgbGVzcyB0aGFuIHtzaXplfUtCXCJcclxuICAgIH1cclxuICB9LFxyXG4gIGZyOiB7XHJcbiAgICBcImNvZGVcIjogXCJmclwiLFxyXG4gICAgXCJtZXNzYWdlc1wiOiB7XHJcbiAgICAgIFwiYWxwaGFcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gbmUgcGV1dCBjb250ZW5pciBxdWUgZGVzIGxldHRyZXNcIixcclxuICAgICAgXCJhbHBoYV9udW1cIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gbmUgcGV1dCBjb250ZW5pciBxdWUgZGVzIGNhcmFjdMOocmVzIGFscGhhLW51bcOpcmlxdWVzXCIsXHJcbiAgICAgIFwiYWxwaGFfZGFzaFwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBwZXV0IGNvbnRlbmlyIHF1ZSBkZXMgY2FyYWN0w6hyZXMgYWxwaGEtbnVtw6lyaXF1ZXMsIHRpcmV0cyBvdSBzb3VsaWduw6lzXCIsXHJcbiAgICAgIFwiYWxwaGFfc3BhY2VzXCI6IFwiTGUgY2hhbXAge19maWVsZF99IG5lIHBldXQgY29udGVuaXIgcXVlIGRlcyBsZXR0cmVzIG91IGRlcyBlc3BhY2VzXCIsXHJcbiAgICAgIFwiYmV0d2VlblwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IMOqdHJlIGNvbXByaXMgZW50cmUge21pbn0gZXQge21heH1cIixcclxuICAgICAgXCJjb25maXJtZWRcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gbmUgY29ycmVzcG9uZCBwYXNcIixcclxuICAgICAgXCJkaWdpdHNcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1biBub21icmUgZW50aWVyIGRlIHtsZW5ndGh9IGNoaWZmcmVzXCIsXHJcbiAgICAgIFwiZGltZW5zaW9uc1wiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IGF2b2lyIHVuZSB0YWlsbGUgZGUge3dpZHRofSBwaXhlbHMgcGFyIHtoZWlnaHR9IHBpeGVsc1wiLFxyXG4gICAgICBcImVtYWlsXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgw6p0cmUgdW5lIGFkcmVzc2UgZS1tYWlsIHZhbGlkZVwiLFxyXG4gICAgICBcImV4Y2x1ZGVkXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgw6p0cmUgdW5lIHZhbGV1ciB2YWxpZGVcIixcclxuICAgICAgXCJleHRcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1biBmaWNoaWVyIHZhbGlkZVwiLFxyXG4gICAgICBcImltYWdlXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgw6p0cmUgdW5lIGltYWdlXCIsXHJcbiAgICAgIFwiaW50ZWdlclwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IMOqdHJlIHVuIGVudGllclwiLFxyXG4gICAgICBcImxlbmd0aFwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IGNvbnRlbmlyIHtsZW5ndGh9IGNhcmFjdMOocmVzXCIsXHJcbiAgICAgIFwibWF4X3ZhbHVlXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgYXZvaXIgdW5lIHZhbGV1ciBkZSB7bWF4fSBvdSBtb2luc1wiLFxyXG4gICAgICBcIm1heFwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBwZXV0IHBhcyBjb250ZW5pciBwbHVzIGRlIHtsZW5ndGh9IGNhcmFjdMOocmVzXCIsXHJcbiAgICAgIFwibWltZXNcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCBhdm9pciB1biB0eXBlIE1JTUUgdmFsaWRlXCIsXHJcbiAgICAgIFwibWluX3ZhbHVlXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgYXZvaXIgdW5lIHZhbGV1ciBkZSB7bWlufSBvdSBwbHVzXCIsXHJcbiAgICAgIFwibWluXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgY29udGVuaXIgYXUgbWluaW11bSB7bGVuZ3RofSBjYXJhY3TDqHJlc1wiLFxyXG4gICAgICBcIm51bWVyaWNcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gbmUgcGV1dCBjb250ZW5pciBxdWUgZGVzIGNoaWZmcmVzXCIsXHJcbiAgICAgIFwib25lT2ZcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1bmUgdmFsZXVyIHZhbGlkZVwiLFxyXG4gICAgICBcInJlZ2V4XCI6IFwiTGUgY2hhbXAge19maWVsZF99IGVzdCBpbnZhbGlkZVwiLFxyXG4gICAgICBcInJlcXVpcmVkXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGVzdCBvYmxpZ2F0b2lyZVwiLFxyXG4gICAgICBcInJlcXVpcmVkX2lmXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGVzdCBvYmxpZ2F0b2lyZSBsb3JzcXVlIHt0YXJnZXR9IHBvc3PDqGRlIGNldHRlIHZhbGV1clwiLFxyXG4gICAgICBcInNpemVcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCBhdm9pciB1biBwb2lkcyBpbmbDqXJpZXVyIMOgIHtzaXplfUtCXCJcclxuICAgIH1cclxuICB9LFxyXG59KTtcclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmZ1bmN0aW9uIGRlY29kZVVuaWNvZGUoc3RyKSB7XG4gIC8vIEdvaW5nIGJhY2t3YXJkczogZnJvbSBieXRlc3RyZWFtLCB0byBwZXJjZW50LWVuY29kaW5nLCB0byBvcmlnaW5hbCBzdHJpbmcuXG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoYXRvYihzdHIpLnNwbGl0KCcnKS5tYXAoZnVuY3Rpb24gKGMpIHtcbiAgICByZXR1cm4gJyUnICsgKCcwMCcgKyBjLmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpKS5zbGljZSgtMik7XG4gIH0pLmpvaW4oJycpKTtcbn1cblxuXG4vLyBydW4gaW5pdCBzY3JpcHRcbmZ1bmN0aW9uIGluaXRGb3JtKGFwcCkge1xuXG4gIC8vIFNldCBWZWVWYWxpZGF0ZSBsYW5ndWFnZSBiYXNlZCBvbiB0aGUgbGFuZyBwYXJhbWV0ZXJcbiAgVmVlVmFsaWRhdGUubG9jYWxpemUoYXBwLmRhdGFzZXQubGFuZyk7XG5cbiAgbGV0IGNvbXBvbmVudE9wdGlvbnMgPSBhcHAuZGF0YXNldC5vcHRpb25zO1xuXG4gIGxldCBwYXJzZWRPcHRpb25zID0ge307XG4gIGlmKGNvbXBvbmVudE9wdGlvbnMpICB7XG4gICAgY29uc3QgZm4gPSBuZXcgRnVuY3Rpb24oYHJldHVybiAke2RlY29kZVVuaWNvZGUoY29tcG9uZW50T3B0aW9ucyl9O2ApO1xuICAgIHBhcnNlZE9wdGlvbnMgPSBmbigpO1xuICB9XG5cbiAgY29uc3QgeyBkYXRhOiBwYXJzZWREYXRhLCBtZXRob2RzOiBwYXJzZWRNZXRob2RzLCAuLi5wYXJzZWRSZXN0IH0gPSBwYXJzZWRPcHRpb25zO1xuICBsZXQgb2JqRGF0YSA9IHBhcnNlZERhdGE7XG4gIGlmKHR5cGVvZiBwYXJzZWREYXRhID09PSBcImZ1bmN0aW9uXCIpXG4gIHtcbiAgICBvYmpEYXRhID0gcGFyc2VkRGF0YSgpO1xuICB9XG4gIGNvbnN0IGRlZmF1bHRGb3JtRGF0YSA9IHtcbiAgICBzdWJtaXR0aW5nOiBmYWxzZSxcbiAgICBzdWJtaXRTdWNjZXNzOiBmYWxzZSxcbiAgICBzdWNjZXNzTWVzc2FnZTogdW5kZWZpbmVkLFxuICAgIHN1Ym1pdEVycm9yOiBmYWxzZSxcbiAgICBzdWJtaXRWYWxpZGF0aW9uRXJyb3JzOiBmYWxzZSxcbiAgICBzZXJ2ZXJWYWxpZGF0aW9uTWVzc2FnZTogdW5kZWZpbmVkLFxuICAgIHNlcnZlckVycm9yTWVzc2FnZTogdW5kZWZpbmVkXG4gIH1cblxuICAvL3RvZG8gY29tcG9uZW50IG5hbWVcbiAgVnVlLmNvbXBvbmVudChhcHAuZGF0YXNldC5uYW1lLCB7XG4gICAgLy8gRmlyc3QgYmVjYXVzZSB0aGUgZWxlbWVudHMgYmVsb3cgd2lsbCBvdmVycmlkZVxuICAgIC4uLnBhcnNlZFJlc3QsXG4gICAgdGVtcGxhdGU6IGAjJHthcHAuZGF0YXNldC5uYW1lfWAsXG4gICAgZGF0YTogZnVuY3Rpb24gKCkgeyBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLm9iakRhdGEsXG4gICAgICAgIGZvcm06IHsuLi5kZWZhdWx0Rm9ybURhdGF9XG4gICAgICB9O1xuICAgIH0sXG4gICAgbWV0aG9kczoge1xuICAgICAgLi4ucGFyc2VkTWV0aG9kcyxcbiAgICAgIGZvcm1SZXNldCgpIHtcbiAgICAgICAgdGhpcy5mb3JtID0gey4uLmRlZmF1bHRGb3JtRGF0YX07XG4gICAgICAgIC8vIGFsc28gcmVzZXQgdGhlIFZlZVZhbGlkYXRlIG9ic2VydmVyXG4gICAgICAgIHRoaXMuJHJlZnMub2JzLnJlc2V0KCk7XG4gICAgICB9LFxuICAgICAgZm9ybUhhbmRsZVN1Ym1pdChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgY29uc3Qgdm0gPSB0aGlzO1xuICAgICAgICAvLyBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZSBWZWVWYWxpZGF0ZSBvYnNlcnZlclxuICAgICAgICBjb25zdCBvYnNlcnZlciA9IHZtLiRyZWZzLm9icztcbiAgICAgICAgb2JzZXJ2ZXIudmFsaWRhdGUoKS50aGVuKCh2YWxpZCkgPT4ge1xuICAgICAgICAgIGlmICh2YWxpZCkge1xuICAgICAgICAgICAgY29uc3QgYWN0aW9uID0gdm0uJHJlZnMuZm9ybS5nZXRBdHRyaWJ1dGUoXCJhY3Rpb25cIik7XG4gICAgICAgICAgICB2YXIgdG9rZW4gPSB2bS4kcmVmcy5mb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJfX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlblwiXScpOztcbiAgICAgICAgICAgIHZtLmZvcm0uc3VibWl0dGluZyA9IHRydWU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICB1cmw6IGFjdGlvbixcbiAgICAgICAgICAgICAgZGF0YTogey4uLnZtLiRkYXRhLCBfX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbjogdG9rZW4udmFsdWUgfSxcbiAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB2bS5mb3JtID0gey4uLmRlZmF1bHRGb3JtRGF0YX07XG4gICAgICAgICAgICAgICAgLy8gaWYgdGhlcmUgYXJlIHZhbGlkYXRpb24gZXJyb3JzIG9uIHRoZSBmb3JtLCBkaXNwbGF5IHRoZW0uXG4gICAgICAgICAgICAgICAgaWYgKGRhdGEudmFsaWRhdGlvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAvLyBzcGVjaWFsIGtleSBmb3Igc2VydmVyRXJyb3JNZXNzYWdlc1xuICAgICAgICAgICAgICAgICAgaWYoZGF0YS5lcnJvcnNbJ3NlcnZlclZhbGlkYXRpb25NZXNzYWdlJ10gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2bS5mb3JtLnNlcnZlclZhbGlkYXRpb25NZXNzYWdlID0gZGF0YS5lcnJvcnNbJ3NlcnZlclZhbGlkYXRpb25NZXNzYWdlJ107XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB2bS5mb3JtLnN1Ym1pdFZhbGlkYXRpb25FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5zZXRFcnJvcnMoZGF0YS5lcnJvcnMpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgc2VuZHMgYSByZWRpcmVjdCwgcmVsb2FkIHRoZSB3aW5kb3dcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5yZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBkYXRhLnJlZGlyZWN0O1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vc3VjY2Vzcywgc2V0IHRoZSBmb3JtIHN1Y2Nlc3MgbWVzc2FnZSBcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICB2bS5mb3JtLnN1Ym1pdFN1Y2Nlc3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgdm0uZm9ybS5zdWNjZXNzTWVzc2FnZSA9IGRhdGEuc3VjY2Vzc01lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZtLmZvcm0uc3VibWl0RXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nLCBkZXYgaXNzdWVcbiAgICAgICAgICAgICAgICB2bS5mb3JtLnNlcnZlckVycm9yTWVzc2FnZSA9IFwiU29tZXRoaW5nIHdlbid0IHdyb25nLiBQbGVhc2UgcmVwb3J0IHRoaXMgdG8geW91ciBzaXRlIGFkbWluaXN0cmF0b3JzLiBFcnJvciBjb2RlOiBgVnVlRm9ybXMuQWpheEhhbmRsZXJgXCI7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCBzdGF0dXNUZXh0KSB7XG4gICAgICAgICAgICAgICAgdm0uZm9ybSA9IHsuLi5kZWZhdWx0Rm9ybURhdGF9O1xuICAgICAgICAgICAgICAgIHZtLmZvcm0uc3VibWl0RXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZtLmZvcm0uc2VydmVyRXJyb3JNZXNzYWdlID0gYCR7eGhyLnN0YXR1c30gJHtzdGF0dXNUZXh0fWA7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8vIHJ1biB0aGUgdnVlLWZvcm0gaW5pdCBzY3JpcHQgcHJvdmlkZWQgaW4gdGhlIE9DIGFkbWluIHVpXG4gIGxldCBpbml0U2NyaXB0ID0gYXBwLmRhdGFzZXQuaW5pdFNjcmlwdDtcbiAgaWYgKGluaXRTY3JpcHQpIHtcbiAgICBjb25zdCBpbml0Rm4gPSBuZXcgRnVuY3Rpb24oZGVjb2RlVW5pY29kZShpbml0U2NyaXB0KSk7XG4gICAgaW5pdEZuKCk7XG4gIH1cbn1cblxuXG4vLyBsb29rIGZvciBhbGwgdnVlIGZvcm1zIHdoZW4gdGhpcyBzY3JpcHQgaXMgbG9hZGVkIGFuZCBpbml0aWFsaXplIHRoZW1cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIudnVlLWZvcm1cIikuZm9yRWFjaChpbml0Rm9ybSk7XG5jb25zdCBmb3JtTG9hZGVkRXZlbnQgPSBuZXcgRXZlbnQoJ3Z1ZS1mb3JtLWNvbXBvbmVudC1sb2FkZWQnKTtcbmRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZm9ybUxvYWRlZEV2ZW50KTtcblxuIl19
