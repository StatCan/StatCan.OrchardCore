/*
** NOTE: This file is generated by Gulp and should not be edited directly!
** Any changes made directly to this file will be overwritten next time its asset group is processed by Gulp.
*/

// register VeeValidate components globally
Vue.component('validation-provider', VeeValidate.ValidationProvider);
Vue.component('validation-observer', VeeValidate.ValidationObserver); // include default english and french translations.

VeeValidate.localize({
  en: {
    "code": "en",
    "messages": {
      "alpha": "The {_field_} field may only contain alphabetic characters",
      "alpha_num": "The {_field_} field may only contain alpha-numeric characters",
      "alpha_dash": "The {_field_} field may contain alpha-numeric characters as well as dashes and underscores",
      "alpha_spaces": "The {_field_} field may only contain alphabetic characters as well as spaces",
      "between": "The {_field_} field must be between {min} and {max}",
      "confirmed": "The {_field_} field confirmation does not match",
      "digits": "The {_field_} field must be numeric and exactly contain {length} digits",
      "dimensions": "The {_field_} field must be {width} pixels by {height} pixels",
      "email": "The {_field_} field must be a valid email",
      "excluded": "The {_field_} field is not a valid value",
      "ext": "The {_field_} field is not a valid file",
      "image": "The {_field_} field must be an image",
      "integer": "The {_field_} field must be an integer",
      "length": "The {_field_} field must be {length} long",
      "max_value": "The {_field_} field must be {max} or less",
      "max": "The {_field_} field may not be greater than {length} characters",
      "mimes": "The {_field_} field must have a valid file type",
      "min_value": "The {_field_} field must be {min} or more",
      "min": "The {_field_} field must be at least {length} characters",
      "numeric": "The {_field_} field may only contain numeric characters",
      "oneOf": "The {_field_} field is not a valid value",
      "regex": "The {_field_} field format is invalid",
      "required_if": "The {_field_} field is required",
      "required": "The {_field_} field is required",
      "size": "The {_field_} field size must be less than {size}KB"
    }
  },
  fr: {
    "code": "fr",
    "messages": {
      "alpha": "Le champ {_field_} ne peut contenir que des lettres",
      "alpha_num": "Le champ {_field_} ne peut contenir que des caractères alpha-numériques",
      "alpha_dash": "Le champ {_field_} ne peut contenir que des caractères alpha-numériques, tirets ou soulignés",
      "alpha_spaces": "Le champ {_field_} ne peut contenir que des lettres ou des espaces",
      "between": "Le champ {_field_} doit être compris entre {min} et {max}",
      "confirmed": "Le champ {_field_} ne correspond pas",
      "digits": "Le champ {_field_} doit être un nombre entier de {length} chiffres",
      "dimensions": "Le champ {_field_} doit avoir une taille de {width} pixels par {height} pixels",
      "email": "Le champ {_field_} doit être une adresse e-mail valide",
      "excluded": "Le champ {_field_} doit être une valeur valide",
      "ext": "Le champ {_field_} doit être un fichier valide",
      "image": "Le champ {_field_} doit être une image",
      "integer": "Le champ {_field_} doit être un entier",
      "length": "Le champ {_field_} doit contenir {length} caractères",
      "max_value": "Le champ {_field_} doit avoir une valeur de {max} ou moins",
      "max": "Le champ {_field_} ne peut pas contenir plus de {length} caractères",
      "mimes": "Le champ {_field_} doit avoir un type MIME valide",
      "min_value": "Le champ {_field_} doit avoir une valeur de {min} ou plus",
      "min": "Le champ {_field_} doit contenir au minimum {length} caractères",
      "numeric": "Le champ {_field_} ne peut contenir que des chiffres",
      "oneOf": "Le champ {_field_} doit être une valeur valide",
      "regex": "Le champ {_field_} est invalide",
      "required": "Le champ {_field_} est obligatoire",
      "required_if": "Le champ {_field_} est obligatoire lorsque {target} possède cette valeur",
      "size": "Le champ {_field_} doit avoir un poids inférieur à {size}KB"
    }
  }
});
"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function decodeUnicode(str) {
  return decodeURIComponent(atob(str).split('').map(function (c) {
    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
  }).join(''));
} // run init script


function initForm(app) {
  // Set VeeValidate language based on the lang parameter
  VeeValidate.localize(app.dataset.lang);
  var componentOptions = app.dataset.options;
  var parsedOptions = {};

  if (componentOptions) {
    var fn = new Function("return ".concat(decodeUnicode(componentOptions), ";"));
    parsedOptions = fn();
  }

  var _parsedOptions = parsedOptions,
      parsedData = _parsedOptions.data,
      parsedMethods = _parsedOptions.methods,
      parsedRest = _objectWithoutProperties(_parsedOptions, ["data", "methods"]);

  var objData = parsedData;

  if (typeof parsedData === "function") {
    objData = parsedData();
  }

  var defaultFormData = {
    submitting: false,
    submitSuccess: false,
    successMessage: undefined,
    submitError: false,
    submitValidationErrors: false,
    serverValidationMessage: undefined,
    serverErrorMessage: undefined,
    responseData: undefined
  };
  Vue.component(app.dataset.name, _objectSpread(_objectSpread({}, parsedRest), {}, {
    template: "#".concat(app.dataset.name),
    data: function data() {
      return _objectSpread(_objectSpread({}, objData), {}, {
        form: _objectSpread({}, defaultFormData)
      });
    },
    methods: _objectSpread(_objectSpread({
      // default method that return the data to be submitted to the server
      // this was added first to allow the Administrator to edit this function on the OC Admin
      submitData: function submitData() {
        return _objectSpread({}, this.$data);
      }
    }, parsedMethods), {}, {
      formReset: function formReset() {
        this.form = _objectSpread({}, defaultFormData); // also reset the VeeValidate observer

        this.$refs.obs.reset();
      },
      formHandleSubmit: function formHandleSubmit(e) {
        e.preventDefault();
        var vm = this; // keep a reference to the VeeValidate observer

        var observer = vm.$refs.obs;
        observer.validate().then(function (valid) {
          if (valid) {
            var action = vm.$refs.form.getAttribute("action");
            var frmData = vm.submitData();
            frmData.__RequestVerificationToken = vm.$refs.form.querySelector('input[name="__RequestVerificationToken"]').value;

            if ((typeof grecaptcha === "undefined" ? "undefined" : _typeof(grecaptcha)) == 'object') {
              frmData.recaptcha = grecaptcha.getResponse();
            }

            vm.form.submitting = true;
            $.ajax({
              type: "POST",
              url: action,
              data: frmData,
              cache: false,
              dataType: "json",
              success: function success(data) {
                vm.form = _objectSpread({}, defaultFormData);
                vm.form.responseData = data; // if there are validation errors on the form, display them.

                if (data.validationError) {
                  //legacy
                  if (data.errors['serverValidationMessage'] != null) {
                    vm.form.serverValidationMessage = data.errors['serverValidationMessage'];
                  }

                  vm.form.submitValidationError = true;
                  observer.setErrors(data.errors);
                  return;
                } // if the server sends a redirect, reload the window


                if (data.redirect) {
                  window.location.href = data.redirect;
                  return;
                }

                vm.form.submitSuccess = true;
                vm.form.successMessage = data.successMessage;
                return;
              },
              error: function error(xhr, statusText) {
                vm.form = _objectSpread({}, defaultFormData);
                vm.form.submitError = true;
                vm.form.serverErrorMessage = "".concat(xhr.status, " ").concat(statusText);
              }
            });
          }
        });
        return false;
      }
    })
  })); // run the vue-form init script provided in the OC admin ui

  var initScript = app.dataset.initScript;

  if (initScript) {
    var initFn = new Function(decodeUnicode(initScript));
    initFn();
  }
} // look for all vue forms when this script is loaded and initialize them


document.querySelectorAll(".vue-form").forEach(initForm);
document.addEventListener("DOMContentLoaded", function (event) {
  var formLoadedEvent = new Event('vue-form-component-loaded');
  document.dispatchEvent(formLoadedEvent);
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZlZXZhbGlkYXRlLXNldHVwLmpzIiwidnVlLWZvcm1zLmpzIl0sIm5hbWVzIjpbIlZ1ZSIsImNvbXBvbmVudCIsIlZlZVZhbGlkYXRlIiwiVmFsaWRhdGlvblByb3ZpZGVyIiwiVmFsaWRhdGlvbk9ic2VydmVyIiwibG9jYWxpemUiLCJlbiIsImZyIiwiZGVjb2RlVW5pY29kZSIsInN0ciIsImRlY29kZVVSSUNvbXBvbmVudCIsImF0b2IiLCJzcGxpdCIsIm1hcCIsImMiLCJjaGFyQ29kZUF0IiwidG9TdHJpbmciLCJzbGljZSIsImpvaW4iLCJpbml0Rm9ybSIsImFwcCIsImRhdGFzZXQiLCJsYW5nIiwiY29tcG9uZW50T3B0aW9ucyIsIm9wdGlvbnMiLCJwYXJzZWRPcHRpb25zIiwiZm4iLCJGdW5jdGlvbiIsInBhcnNlZERhdGEiLCJkYXRhIiwicGFyc2VkTWV0aG9kcyIsIm1ldGhvZHMiLCJwYXJzZWRSZXN0Iiwib2JqRGF0YSIsImRlZmF1bHRGb3JtRGF0YSIsInN1Ym1pdHRpbmciLCJzdWJtaXRTdWNjZXNzIiwic3VjY2Vzc01lc3NhZ2UiLCJ1bmRlZmluZWQiLCJzdWJtaXRFcnJvciIsInN1Ym1pdFZhbGlkYXRpb25FcnJvcnMiLCJzZXJ2ZXJWYWxpZGF0aW9uTWVzc2FnZSIsInNlcnZlckVycm9yTWVzc2FnZSIsInJlc3BvbnNlRGF0YSIsIm5hbWUiLCJ0ZW1wbGF0ZSIsImZvcm0iLCJzdWJtaXREYXRhIiwiJGRhdGEiLCJmb3JtUmVzZXQiLCIkcmVmcyIsIm9icyIsInJlc2V0IiwiZm9ybUhhbmRsZVN1Ym1pdCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInZtIiwib2JzZXJ2ZXIiLCJ2YWxpZGF0ZSIsInRoZW4iLCJ2YWxpZCIsImFjdGlvbiIsImdldEF0dHJpYnV0ZSIsImZybURhdGEiLCJfX1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbiIsInF1ZXJ5U2VsZWN0b3IiLCJ2YWx1ZSIsImdyZWNhcHRjaGEiLCJyZWNhcHRjaGEiLCJnZXRSZXNwb25zZSIsIiQiLCJhamF4IiwidHlwZSIsInVybCIsImNhY2hlIiwiZGF0YVR5cGUiLCJzdWNjZXNzIiwidmFsaWRhdGlvbkVycm9yIiwiZXJyb3JzIiwic3VibWl0VmFsaWRhdGlvbkVycm9yIiwic2V0RXJyb3JzIiwicmVkaXJlY3QiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJlcnJvciIsInhociIsInN0YXR1c1RleHQiLCJzdGF0dXMiLCJpbml0U2NyaXB0IiwiaW5pdEZuIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImZvcm1Mb2FkZWRFdmVudCIsIkV2ZW50IiwiZGlzcGF0Y2hFdmVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDQTtBQUNBQSxHQUFHLENBQUNDLFNBQUosQ0FBYyxxQkFBZCxFQUFxQ0MsV0FBVyxDQUFDQyxrQkFBakQ7QUFDQUgsR0FBRyxDQUFDQyxTQUFKLENBQWMscUJBQWQsRUFBcUNDLFdBQVcsQ0FBQ0Usa0JBQWpELEUsQ0FFQTs7QUFDQUYsV0FBVyxDQUFDRyxRQUFaLENBQXFCO0FBQ25CQyxFQUFBQSxFQUFFLEVBQUM7QUFDRCxZQUFRLElBRFA7QUFFRCxnQkFBWTtBQUNWLGVBQVMsNERBREM7QUFFVixtQkFBYSwrREFGSDtBQUdWLG9CQUFjLDRGQUhKO0FBSVYsc0JBQWdCLDhFQUpOO0FBS1YsaUJBQVcscURBTEQ7QUFNVixtQkFBYSxpREFOSDtBQU9WLGdCQUFVLHlFQVBBO0FBUVYsb0JBQWMsK0RBUko7QUFTVixlQUFTLDJDQVRDO0FBVVYsa0JBQVksMENBVkY7QUFXVixhQUFPLHlDQVhHO0FBWVYsZUFBUyxzQ0FaQztBQWFWLGlCQUFXLHdDQWJEO0FBY1YsZ0JBQVUsMkNBZEE7QUFlVixtQkFBYSwyQ0FmSDtBQWdCVixhQUFPLGlFQWhCRztBQWlCVixlQUFTLGlEQWpCQztBQWtCVixtQkFBYSwyQ0FsQkg7QUFtQlYsYUFBTywwREFuQkc7QUFvQlYsaUJBQVcseURBcEJEO0FBcUJWLGVBQVMsMENBckJDO0FBc0JWLGVBQVMsdUNBdEJDO0FBdUJWLHFCQUFlLGlDQXZCTDtBQXdCVixrQkFBWSxpQ0F4QkY7QUF5QlYsY0FBUTtBQXpCRTtBQUZYLEdBRGdCO0FBK0JuQkMsRUFBQUEsRUFBRSxFQUFFO0FBQ0YsWUFBUSxJQUROO0FBRUYsZ0JBQVk7QUFDVixlQUFTLHFEQURDO0FBRVYsbUJBQWEseUVBRkg7QUFHVixvQkFBYyw4RkFISjtBQUlWLHNCQUFnQixvRUFKTjtBQUtWLGlCQUFXLDJEQUxEO0FBTVYsbUJBQWEsc0NBTkg7QUFPVixnQkFBVSxvRUFQQTtBQVFWLG9CQUFjLGdGQVJKO0FBU1YsZUFBUyx3REFUQztBQVVWLGtCQUFZLGdEQVZGO0FBV1YsYUFBTyxnREFYRztBQVlWLGVBQVMsd0NBWkM7QUFhVixpQkFBVyx3Q0FiRDtBQWNWLGdCQUFVLHNEQWRBO0FBZVYsbUJBQWEsNERBZkg7QUFnQlYsYUFBTyxxRUFoQkc7QUFpQlYsZUFBUyxtREFqQkM7QUFrQlYsbUJBQWEsMkRBbEJIO0FBbUJWLGFBQU8saUVBbkJHO0FBb0JWLGlCQUFXLHNEQXBCRDtBQXFCVixlQUFTLGdEQXJCQztBQXNCVixlQUFTLGlDQXRCQztBQXVCVixrQkFBWSxvQ0F2QkY7QUF3QlYscUJBQWUsMEVBeEJMO0FBeUJWLGNBQVE7QUF6QkU7QUFGVjtBQS9CZSxDQUFyQjtBQ05BOzs7Ozs7Ozs7Ozs7OztBQUVBLFNBQVNDLGFBQVQsQ0FBdUJDLEdBQXZCLEVBQTRCO0FBQzFCLFNBQU9DLGtCQUFrQixDQUFDQyxJQUFJLENBQUNGLEdBQUQsQ0FBSixDQUFVRyxLQUFWLENBQWdCLEVBQWhCLEVBQW9CQyxHQUFwQixDQUF3QixVQUFVQyxDQUFWLEVBQWE7QUFDN0QsV0FBTyxNQUFNLENBQUMsT0FBT0EsQ0FBQyxDQUFDQyxVQUFGLENBQWEsQ0FBYixFQUFnQkMsUUFBaEIsQ0FBeUIsRUFBekIsQ0FBUixFQUFzQ0MsS0FBdEMsQ0FBNEMsQ0FBQyxDQUE3QyxDQUFiO0FBQ0QsR0FGeUIsRUFFdkJDLElBRnVCLENBRWxCLEVBRmtCLENBQUQsQ0FBekI7QUFHRCxDLENBR0Q7OztBQUNBLFNBQVNDLFFBQVQsQ0FBa0JDLEdBQWxCLEVBQXVCO0FBRXJCO0FBQ0FsQixFQUFBQSxXQUFXLENBQUNHLFFBQVosQ0FBcUJlLEdBQUcsQ0FBQ0MsT0FBSixDQUFZQyxJQUFqQztBQUVBLE1BQUlDLGdCQUFnQixHQUFHSCxHQUFHLENBQUNDLE9BQUosQ0FBWUcsT0FBbkM7QUFFQSxNQUFJQyxhQUFhLEdBQUcsRUFBcEI7O0FBQ0EsTUFBR0YsZ0JBQUgsRUFBc0I7QUFDcEIsUUFBTUcsRUFBRSxHQUFHLElBQUlDLFFBQUosa0JBQXVCbkIsYUFBYSxDQUFDZSxnQkFBRCxDQUFwQyxPQUFYO0FBQ0FFLElBQUFBLGFBQWEsR0FBR0MsRUFBRSxFQUFsQjtBQUNEOztBQVhvQix1QkFhK0NELGFBYi9DO0FBQUEsTUFhUEcsVUFiTyxrQkFhYkMsSUFiYTtBQUFBLE1BYWNDLGFBYmQsa0JBYUtDLE9BYkw7QUFBQSxNQWFnQ0MsVUFiaEM7O0FBY3JCLE1BQUlDLE9BQU8sR0FBR0wsVUFBZDs7QUFDQSxNQUFHLE9BQU9BLFVBQVAsS0FBc0IsVUFBekIsRUFDQTtBQUNFSyxJQUFBQSxPQUFPLEdBQUdMLFVBQVUsRUFBcEI7QUFDRDs7QUFDRCxNQUFNTSxlQUFlLEdBQUc7QUFDdEJDLElBQUFBLFVBQVUsRUFBRSxLQURVO0FBRXRCQyxJQUFBQSxhQUFhLEVBQUUsS0FGTztBQUd0QkMsSUFBQUEsY0FBYyxFQUFFQyxTQUhNO0FBSXRCQyxJQUFBQSxXQUFXLEVBQUUsS0FKUztBQUt0QkMsSUFBQUEsc0JBQXNCLEVBQUUsS0FMRjtBQU10QkMsSUFBQUEsdUJBQXVCLEVBQUVILFNBTkg7QUFPdEJJLElBQUFBLGtCQUFrQixFQUFFSixTQVBFO0FBUXRCSyxJQUFBQSxZQUFZLEVBQUVMO0FBUlEsR0FBeEI7QUFXQXRDLEVBQUFBLEdBQUcsQ0FBQ0MsU0FBSixDQUFjbUIsR0FBRyxDQUFDQyxPQUFKLENBQVl1QixJQUExQixrQ0FFS1osVUFGTDtBQUdFYSxJQUFBQSxRQUFRLGFBQU16QixHQUFHLENBQUNDLE9BQUosQ0FBWXVCLElBQWxCLENBSFY7QUFJRWYsSUFBQUEsSUFBSSxFQUFFLGdCQUFZO0FBQ2hCLDZDQUNLSSxPQURMO0FBRUVhLFFBQUFBLElBQUksb0JBQU1aLGVBQU47QUFGTjtBQUlELEtBVEg7QUFVRUgsSUFBQUEsT0FBTztBQUNMO0FBQ0E7QUFDQWdCLE1BQUFBLFVBSEssd0JBR1E7QUFDWCxpQ0FBVyxLQUFLQyxLQUFoQjtBQUNEO0FBTEksT0FNRmxCLGFBTkU7QUFPTG1CLE1BQUFBLFNBUEssdUJBT087QUFDVixhQUFLSCxJQUFMLHFCQUFnQlosZUFBaEIsRUFEVSxDQUVWOztBQUNBLGFBQUtnQixLQUFMLENBQVdDLEdBQVgsQ0FBZUMsS0FBZjtBQUNELE9BWEk7QUFZTEMsTUFBQUEsZ0JBWkssNEJBWVlDLENBWlosRUFZZTtBQUNsQkEsUUFBQUEsQ0FBQyxDQUFDQyxjQUFGO0FBQ0EsWUFBTUMsRUFBRSxHQUFHLElBQVgsQ0FGa0IsQ0FHbEI7O0FBQ0EsWUFBTUMsUUFBUSxHQUFHRCxFQUFFLENBQUNOLEtBQUgsQ0FBU0MsR0FBMUI7QUFDQU0sUUFBQUEsUUFBUSxDQUFDQyxRQUFULEdBQW9CQyxJQUFwQixDQUF5QixVQUFDQyxLQUFELEVBQVc7QUFDbEMsY0FBSUEsS0FBSixFQUFXO0FBQ1QsZ0JBQU1DLE1BQU0sR0FBR0wsRUFBRSxDQUFDTixLQUFILENBQVNKLElBQVQsQ0FBY2dCLFlBQWQsQ0FBMkIsUUFBM0IsQ0FBZjtBQUNBLGdCQUFJQyxPQUFPLEdBQUdQLEVBQUUsQ0FBQ1QsVUFBSCxFQUFkO0FBQ0FnQixZQUFBQSxPQUFPLENBQUNDLDBCQUFSLEdBQXFDUixFQUFFLENBQUNOLEtBQUgsQ0FBU0osSUFBVCxDQUFjbUIsYUFBZCxDQUE0QiwwQ0FBNUIsRUFBd0VDLEtBQTdHOztBQUNBLGdCQUFHLFFBQU9DLFVBQVAseUNBQU9BLFVBQVAsTUFBc0IsUUFBekIsRUFDQTtBQUNFSixjQUFBQSxPQUFPLENBQUNLLFNBQVIsR0FBb0JELFVBQVUsQ0FBQ0UsV0FBWCxFQUFwQjtBQUNEOztBQUVEYixZQUFBQSxFQUFFLENBQUNWLElBQUgsQ0FBUVgsVUFBUixHQUFxQixJQUFyQjtBQUVBbUMsWUFBQUEsQ0FBQyxDQUFDQyxJQUFGLENBQU87QUFDTEMsY0FBQUEsSUFBSSxFQUFFLE1BREQ7QUFFTEMsY0FBQUEsR0FBRyxFQUFFWixNQUZBO0FBR0xoQyxjQUFBQSxJQUFJLEVBQUVrQyxPQUhEO0FBSUxXLGNBQUFBLEtBQUssRUFBRSxLQUpGO0FBS0xDLGNBQUFBLFFBQVEsRUFBRSxNQUxMO0FBTUxDLGNBQUFBLE9BQU8sRUFBRSxpQkFBVS9DLElBQVYsRUFBZ0I7QUFFdkIyQixnQkFBQUEsRUFBRSxDQUFDVixJQUFILHFCQUFjWixlQUFkO0FBQ0FzQixnQkFBQUEsRUFBRSxDQUFDVixJQUFILENBQVFILFlBQVIsR0FBdUJkLElBQXZCLENBSHVCLENBSXZCOztBQUNBLG9CQUFJQSxJQUFJLENBQUNnRCxlQUFULEVBQTBCO0FBRXhCO0FBQ0Esc0JBQUdoRCxJQUFJLENBQUNpRCxNQUFMLENBQVkseUJBQVosS0FBMEMsSUFBN0MsRUFBbUQ7QUFDakR0QixvQkFBQUEsRUFBRSxDQUFDVixJQUFILENBQVFMLHVCQUFSLEdBQWtDWixJQUFJLENBQUNpRCxNQUFMLENBQVkseUJBQVosQ0FBbEM7QUFDRDs7QUFDRHRCLGtCQUFBQSxFQUFFLENBQUNWLElBQUgsQ0FBUWlDLHFCQUFSLEdBQWdDLElBQWhDO0FBQ0F0QixrQkFBQUEsUUFBUSxDQUFDdUIsU0FBVCxDQUFtQm5ELElBQUksQ0FBQ2lELE1BQXhCO0FBQ0E7QUFDRCxpQkFkc0IsQ0FnQnZCOzs7QUFDQSxvQkFBSWpELElBQUksQ0FBQ29ELFFBQVQsRUFBbUI7QUFDakJDLGtCQUFBQSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLElBQWhCLEdBQXVCdkQsSUFBSSxDQUFDb0QsUUFBNUI7QUFDQTtBQUNEOztBQUVEekIsZ0JBQUFBLEVBQUUsQ0FBQ1YsSUFBSCxDQUFRVixhQUFSLEdBQXdCLElBQXhCO0FBQ0FvQixnQkFBQUEsRUFBRSxDQUFDVixJQUFILENBQVFULGNBQVIsR0FBeUJSLElBQUksQ0FBQ1EsY0FBOUI7QUFDQTtBQUVELGVBaENJO0FBaUNMZ0QsY0FBQUEsS0FBSyxFQUFFLGVBQVVDLEdBQVYsRUFBZUMsVUFBZixFQUEyQjtBQUNoQy9CLGdCQUFBQSxFQUFFLENBQUNWLElBQUgscUJBQWNaLGVBQWQ7QUFDQXNCLGdCQUFBQSxFQUFFLENBQUNWLElBQUgsQ0FBUVAsV0FBUixHQUFzQixJQUF0QjtBQUNBaUIsZ0JBQUFBLEVBQUUsQ0FBQ1YsSUFBSCxDQUFRSixrQkFBUixhQUFnQzRDLEdBQUcsQ0FBQ0UsTUFBcEMsY0FBOENELFVBQTlDO0FBQ0Q7QUFyQ0ksYUFBUDtBQXVDRDtBQUNGLFNBcEREO0FBcURBLGVBQU8sS0FBUDtBQUNEO0FBdkVJO0FBVlQsTUE5QnFCLENBbUhyQjs7QUFDQSxNQUFJRSxVQUFVLEdBQUdyRSxHQUFHLENBQUNDLE9BQUosQ0FBWW9FLFVBQTdCOztBQUNBLE1BQUlBLFVBQUosRUFBZ0I7QUFDZCxRQUFNQyxNQUFNLEdBQUcsSUFBSS9ELFFBQUosQ0FBYW5CLGFBQWEsQ0FBQ2lGLFVBQUQsQ0FBMUIsQ0FBZjtBQUNBQyxJQUFBQSxNQUFNO0FBQ1A7QUFDRixDLENBRUQ7OztBQUNBQyxRQUFRLENBQUNDLGdCQUFULENBQTBCLFdBQTFCLEVBQXVDQyxPQUF2QyxDQUErQzFFLFFBQS9DO0FBRUF3RSxRQUFRLENBQUNHLGdCQUFULENBQTBCLGtCQUExQixFQUE4QyxVQUFTQyxLQUFULEVBQWdCO0FBQzVELE1BQU1DLGVBQWUsR0FBRyxJQUFJQyxLQUFKLENBQVUsMkJBQVYsQ0FBeEI7QUFDQU4sRUFBQUEsUUFBUSxDQUFDTyxhQUFULENBQXVCRixlQUF2QjtBQUNELENBSEQiLCJmaWxlIjoidnVlLWZvcm1zLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbi8vIHJlZ2lzdGVyIFZlZVZhbGlkYXRlIGNvbXBvbmVudHMgZ2xvYmFsbHlcclxuVnVlLmNvbXBvbmVudCgndmFsaWRhdGlvbi1wcm92aWRlcicsIFZlZVZhbGlkYXRlLlZhbGlkYXRpb25Qcm92aWRlcik7XHJcblZ1ZS5jb21wb25lbnQoJ3ZhbGlkYXRpb24tb2JzZXJ2ZXInLCBWZWVWYWxpZGF0ZS5WYWxpZGF0aW9uT2JzZXJ2ZXIpOyBcclxuXHJcbi8vIGluY2x1ZGUgZGVmYXVsdCBlbmdsaXNoIGFuZCBmcmVuY2ggdHJhbnNsYXRpb25zLlxyXG5WZWVWYWxpZGF0ZS5sb2NhbGl6ZSh7XHJcbiAgZW46e1xyXG4gICAgXCJjb2RlXCI6IFwiZW5cIixcclxuICAgIFwibWVzc2FnZXNcIjoge1xyXG4gICAgICBcImFscGhhXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgb25seSBjb250YWluIGFscGhhYmV0aWMgY2hhcmFjdGVyc1wiLFxyXG4gICAgICBcImFscGhhX251bVwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbWF5IG9ubHkgY29udGFpbiBhbHBoYS1udW1lcmljIGNoYXJhY3RlcnNcIixcclxuICAgICAgXCJhbHBoYV9kYXNoXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgY29udGFpbiBhbHBoYS1udW1lcmljIGNoYXJhY3RlcnMgYXMgd2VsbCBhcyBkYXNoZXMgYW5kIHVuZGVyc2NvcmVzXCIsXHJcbiAgICAgIFwiYWxwaGFfc3BhY2VzXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgb25seSBjb250YWluIGFscGhhYmV0aWMgY2hhcmFjdGVycyBhcyB3ZWxsIGFzIHNwYWNlc1wiLFxyXG4gICAgICBcImJldHdlZW5cIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUgYmV0d2VlbiB7bWlufSBhbmQge21heH1cIixcclxuICAgICAgXCJjb25maXJtZWRcIjogXCJUaGUge19maWVsZF99IGZpZWxkIGNvbmZpcm1hdGlvbiBkb2VzIG5vdCBtYXRjaFwiLFxyXG4gICAgICBcImRpZ2l0c1wiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSBudW1lcmljIGFuZCBleGFjdGx5IGNvbnRhaW4ge2xlbmd0aH0gZGlnaXRzXCIsXHJcbiAgICAgIFwiZGltZW5zaW9uc1wiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSB7d2lkdGh9IHBpeGVscyBieSB7aGVpZ2h0fSBwaXhlbHNcIixcclxuICAgICAgXCJlbWFpbFwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSBhIHZhbGlkIGVtYWlsXCIsXHJcbiAgICAgIFwiZXhjbHVkZWRcIjogXCJUaGUge19maWVsZF99IGZpZWxkIGlzIG5vdCBhIHZhbGlkIHZhbHVlXCIsXHJcbiAgICAgIFwiZXh0XCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyBub3QgYSB2YWxpZCBmaWxlXCIsXHJcbiAgICAgIFwiaW1hZ2VcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUgYW4gaW1hZ2VcIixcclxuICAgICAgXCJpbnRlZ2VyXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtdXN0IGJlIGFuIGludGVnZXJcIixcclxuICAgICAgXCJsZW5ndGhcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgYmUge2xlbmd0aH0gbG9uZ1wiLFxyXG4gICAgICBcIm1heF92YWx1ZVwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSB7bWF4fSBvciBsZXNzXCIsXHJcbiAgICAgIFwibWF4XCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgbm90IGJlIGdyZWF0ZXIgdGhhbiB7bGVuZ3RofSBjaGFyYWN0ZXJzXCIsXHJcbiAgICAgIFwibWltZXNcIjogXCJUaGUge19maWVsZF99IGZpZWxkIG11c3QgaGF2ZSBhIHZhbGlkIGZpbGUgdHlwZVwiLFxyXG4gICAgICBcIm1pbl92YWx1ZVwiOiBcIlRoZSB7X2ZpZWxkX30gZmllbGQgbXVzdCBiZSB7bWlufSBvciBtb3JlXCIsXHJcbiAgICAgIFwibWluXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtdXN0IGJlIGF0IGxlYXN0IHtsZW5ndGh9IGNoYXJhY3RlcnNcIixcclxuICAgICAgXCJudW1lcmljXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBtYXkgb25seSBjb250YWluIG51bWVyaWMgY2hhcmFjdGVyc1wiLFxyXG4gICAgICBcIm9uZU9mXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyBub3QgYSB2YWxpZCB2YWx1ZVwiLFxyXG4gICAgICBcInJlZ2V4XCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBmb3JtYXQgaXMgaW52YWxpZFwiLFxyXG4gICAgICBcInJlcXVpcmVkX2lmXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyByZXF1aXJlZFwiLFxyXG4gICAgICBcInJlcXVpcmVkXCI6IFwiVGhlIHtfZmllbGRffSBmaWVsZCBpcyByZXF1aXJlZFwiLFxyXG4gICAgICBcInNpemVcIjogXCJUaGUge19maWVsZF99IGZpZWxkIHNpemUgbXVzdCBiZSBsZXNzIHRoYW4ge3NpemV9S0JcIlxyXG4gICAgfVxyXG4gIH0sXHJcbiAgZnI6IHtcclxuICAgIFwiY29kZVwiOiBcImZyXCIsXHJcbiAgICBcIm1lc3NhZ2VzXCI6IHtcclxuICAgICAgXCJhbHBoYVwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBwZXV0IGNvbnRlbmlyIHF1ZSBkZXMgbGV0dHJlc1wiLFxyXG4gICAgICBcImFscGhhX251bVwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBwZXV0IGNvbnRlbmlyIHF1ZSBkZXMgY2FyYWN0w6hyZXMgYWxwaGEtbnVtw6lyaXF1ZXNcIixcclxuICAgICAgXCJhbHBoYV9kYXNoXCI6IFwiTGUgY2hhbXAge19maWVsZF99IG5lIHBldXQgY29udGVuaXIgcXVlIGRlcyBjYXJhY3TDqHJlcyBhbHBoYS1udW3DqXJpcXVlcywgdGlyZXRzIG91IHNvdWxpZ27DqXNcIixcclxuICAgICAgXCJhbHBoYV9zcGFjZXNcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gbmUgcGV1dCBjb250ZW5pciBxdWUgZGVzIGxldHRyZXMgb3UgZGVzIGVzcGFjZXNcIixcclxuICAgICAgXCJiZXR3ZWVuXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgw6p0cmUgY29tcHJpcyBlbnRyZSB7bWlufSBldCB7bWF4fVwiLFxyXG4gICAgICBcImNvbmZpcm1lZFwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBjb3JyZXNwb25kIHBhc1wiLFxyXG4gICAgICBcImRpZ2l0c1wiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IMOqdHJlIHVuIG5vbWJyZSBlbnRpZXIgZGUge2xlbmd0aH0gY2hpZmZyZXNcIixcclxuICAgICAgXCJkaW1lbnNpb25zXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgYXZvaXIgdW5lIHRhaWxsZSBkZSB7d2lkdGh9IHBpeGVscyBwYXIge2hlaWdodH0gcGl4ZWxzXCIsXHJcbiAgICAgIFwiZW1haWxcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1bmUgYWRyZXNzZSBlLW1haWwgdmFsaWRlXCIsXHJcbiAgICAgIFwiZXhjbHVkZWRcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1bmUgdmFsZXVyIHZhbGlkZVwiLFxyXG4gICAgICBcImV4dFwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IMOqdHJlIHVuIGZpY2hpZXIgdmFsaWRlXCIsXHJcbiAgICAgIFwiaW1hZ2VcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCDDqnRyZSB1bmUgaW1hZ2VcIixcclxuICAgICAgXCJpbnRlZ2VyXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgw6p0cmUgdW4gZW50aWVyXCIsXHJcbiAgICAgIFwibGVuZ3RoXCI6IFwiTGUgY2hhbXAge19maWVsZF99IGRvaXQgY29udGVuaXIge2xlbmd0aH0gY2FyYWN0w6hyZXNcIixcclxuICAgICAgXCJtYXhfdmFsdWVcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCBhdm9pciB1bmUgdmFsZXVyIGRlIHttYXh9IG91IG1vaW5zXCIsXHJcbiAgICAgIFwibWF4XCI6IFwiTGUgY2hhbXAge19maWVsZF99IG5lIHBldXQgcGFzIGNvbnRlbmlyIHBsdXMgZGUge2xlbmd0aH0gY2FyYWN0w6hyZXNcIixcclxuICAgICAgXCJtaW1lc1wiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IGF2b2lyIHVuIHR5cGUgTUlNRSB2YWxpZGVcIixcclxuICAgICAgXCJtaW5fdmFsdWVcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCBhdm9pciB1bmUgdmFsZXVyIGRlIHttaW59IG91IHBsdXNcIixcclxuICAgICAgXCJtaW5cIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZG9pdCBjb250ZW5pciBhdSBtaW5pbXVtIHtsZW5ndGh9IGNhcmFjdMOocmVzXCIsXHJcbiAgICAgIFwibnVtZXJpY1wiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBuZSBwZXV0IGNvbnRlbmlyIHF1ZSBkZXMgY2hpZmZyZXNcIixcclxuICAgICAgXCJvbmVPZlwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IMOqdHJlIHVuZSB2YWxldXIgdmFsaWRlXCIsXHJcbiAgICAgIFwicmVnZXhcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZXN0IGludmFsaWRlXCIsXHJcbiAgICAgIFwicmVxdWlyZWRcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZXN0IG9ibGlnYXRvaXJlXCIsXHJcbiAgICAgIFwicmVxdWlyZWRfaWZcIjogXCJMZSBjaGFtcCB7X2ZpZWxkX30gZXN0IG9ibGlnYXRvaXJlIGxvcnNxdWUge3RhcmdldH0gcG9zc8OoZGUgY2V0dGUgdmFsZXVyXCIsXHJcbiAgICAgIFwic2l6ZVwiOiBcIkxlIGNoYW1wIHtfZmllbGRffSBkb2l0IGF2b2lyIHVuIHBvaWRzIGluZsOpcmlldXIgw6Age3NpemV9S0JcIlxyXG4gICAgfVxyXG4gIH0sXHJcbn0pO1xyXG4iLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gZGVjb2RlVW5pY29kZShzdHIpIHtcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChhdG9iKHN0cikuc3BsaXQoJycpLm1hcChmdW5jdGlvbiAoYykge1xuICAgIHJldHVybiAnJScgKyAoJzAwJyArIGMuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikpLnNsaWNlKC0yKTtcbiAgfSkuam9pbignJykpO1xufVxuXG5cbi8vIHJ1biBpbml0IHNjcmlwdFxuZnVuY3Rpb24gaW5pdEZvcm0oYXBwKSB7XG5cbiAgLy8gU2V0IFZlZVZhbGlkYXRlIGxhbmd1YWdlIGJhc2VkIG9uIHRoZSBsYW5nIHBhcmFtZXRlclxuICBWZWVWYWxpZGF0ZS5sb2NhbGl6ZShhcHAuZGF0YXNldC5sYW5nKTtcblxuICBsZXQgY29tcG9uZW50T3B0aW9ucyA9IGFwcC5kYXRhc2V0Lm9wdGlvbnM7XG5cbiAgbGV0IHBhcnNlZE9wdGlvbnMgPSB7fTtcbiAgaWYoY29tcG9uZW50T3B0aW9ucykgIHtcbiAgICBjb25zdCBmbiA9IG5ldyBGdW5jdGlvbihgcmV0dXJuICR7ZGVjb2RlVW5pY29kZShjb21wb25lbnRPcHRpb25zKX07YCk7XG4gICAgcGFyc2VkT3B0aW9ucyA9IGZuKCk7XG4gIH1cblxuICBjb25zdCB7IGRhdGE6IHBhcnNlZERhdGEsIG1ldGhvZHM6IHBhcnNlZE1ldGhvZHMsIC4uLnBhcnNlZFJlc3QgfSA9IHBhcnNlZE9wdGlvbnM7XG4gIGxldCBvYmpEYXRhID0gcGFyc2VkRGF0YTtcbiAgaWYodHlwZW9mIHBhcnNlZERhdGEgPT09IFwiZnVuY3Rpb25cIilcbiAge1xuICAgIG9iakRhdGEgPSBwYXJzZWREYXRhKCk7XG4gIH1cbiAgY29uc3QgZGVmYXVsdEZvcm1EYXRhID0ge1xuICAgIHN1Ym1pdHRpbmc6IGZhbHNlLFxuICAgIHN1Ym1pdFN1Y2Nlc3M6IGZhbHNlLFxuICAgIHN1Y2Nlc3NNZXNzYWdlOiB1bmRlZmluZWQsXG4gICAgc3VibWl0RXJyb3I6IGZhbHNlLFxuICAgIHN1Ym1pdFZhbGlkYXRpb25FcnJvcnM6IGZhbHNlLFxuICAgIHNlcnZlclZhbGlkYXRpb25NZXNzYWdlOiB1bmRlZmluZWQsXG4gICAgc2VydmVyRXJyb3JNZXNzYWdlOiB1bmRlZmluZWQsXG4gICAgcmVzcG9uc2VEYXRhOiB1bmRlZmluZWRcbiAgfVxuXG4gIFZ1ZS5jb21wb25lbnQoYXBwLmRhdGFzZXQubmFtZSwge1xuICAgIC8vIEZpcnN0IGJlY2F1c2UgdGhlIGVsZW1lbnRzIGJlbG93IHdpbGwgb3ZlcnJpZGVcbiAgICAuLi5wYXJzZWRSZXN0LFxuICAgIHRlbXBsYXRlOiBgIyR7YXBwLmRhdGFzZXQubmFtZX1gLFxuICAgIGRhdGE6IGZ1bmN0aW9uICgpIHsgXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5vYmpEYXRhLFxuICAgICAgICBmb3JtOiB7Li4uZGVmYXVsdEZvcm1EYXRhfVxuICAgICAgfTtcbiAgICB9LFxuICAgIG1ldGhvZHM6IHtcbiAgICAgIC8vIGRlZmF1bHQgbWV0aG9kIHRoYXQgcmV0dXJuIHRoZSBkYXRhIHRvIGJlIHN1Ym1pdHRlZCB0byB0aGUgc2VydmVyXG4gICAgICAvLyB0aGlzIHdhcyBhZGRlZCBmaXJzdCB0byBhbGxvdyB0aGUgQWRtaW5pc3RyYXRvciB0byBlZGl0IHRoaXMgZnVuY3Rpb24gb24gdGhlIE9DIEFkbWluXG4gICAgICBzdWJtaXREYXRhKCkge1xuICAgICAgICByZXR1cm4gey4uLnRoaXMuJGRhdGF9O1xuICAgICAgfSxcbiAgICAgIC4uLnBhcnNlZE1ldGhvZHMsXG4gICAgICBmb3JtUmVzZXQoKSB7XG4gICAgICAgIHRoaXMuZm9ybSA9IHsuLi5kZWZhdWx0Rm9ybURhdGF9O1xuICAgICAgICAvLyBhbHNvIHJlc2V0IHRoZSBWZWVWYWxpZGF0ZSBvYnNlcnZlclxuICAgICAgICB0aGlzLiRyZWZzLm9icy5yZXNldCgpO1xuICAgICAgfSxcbiAgICAgIGZvcm1IYW5kbGVTdWJtaXQoZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHZtID0gdGhpcztcbiAgICAgICAgLy8ga2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgVmVlVmFsaWRhdGUgb2JzZXJ2ZXJcbiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSB2bS4kcmVmcy5vYnM7XG4gICAgICAgIG9ic2VydmVyLnZhbGlkYXRlKCkudGhlbigodmFsaWQpID0+IHtcbiAgICAgICAgICBpZiAodmFsaWQpIHtcbiAgICAgICAgICAgIGNvbnN0IGFjdGlvbiA9IHZtLiRyZWZzLmZvcm0uZ2V0QXR0cmlidXRlKFwiYWN0aW9uXCIpO1xuICAgICAgICAgICAgbGV0IGZybURhdGEgPSB2bS5zdWJtaXREYXRhKCk7XG4gICAgICAgICAgICBmcm1EYXRhLl9fUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuID0gdm0uJHJlZnMuZm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiX19SZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW5cIl0nKS52YWx1ZTtcbiAgICAgICAgICAgIGlmKHR5cGVvZihncmVjYXB0Y2hhKSA9PSAnb2JqZWN0JylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgZnJtRGF0YS5yZWNhcHRjaGEgPSBncmVjYXB0Y2hhLmdldFJlc3BvbnNlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZtLmZvcm0uc3VibWl0dGluZyA9IHRydWU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICB1cmw6IGFjdGlvbixcbiAgICAgICAgICAgICAgZGF0YTogZnJtRGF0YSxcbiAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAgICAgICAgICAgICB2bS5mb3JtID0gey4uLmRlZmF1bHRGb3JtRGF0YX07XG4gICAgICAgICAgICAgICAgdm0uZm9ybS5yZXNwb25zZURhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGFyZSB2YWxpZGF0aW9uIGVycm9ycyBvbiB0aGUgZm9ybSwgZGlzcGxheSB0aGVtLlxuICAgICAgICAgICAgICAgIGlmIChkYXRhLnZhbGlkYXRpb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAvL2xlZ2FjeVxuICAgICAgICAgICAgICAgICAgaWYoZGF0YS5lcnJvcnNbJ3NlcnZlclZhbGlkYXRpb25NZXNzYWdlJ10gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB2bS5mb3JtLnNlcnZlclZhbGlkYXRpb25NZXNzYWdlID0gZGF0YS5lcnJvcnNbJ3NlcnZlclZhbGlkYXRpb25NZXNzYWdlJ107XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB2bS5mb3JtLnN1Ym1pdFZhbGlkYXRpb25FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5zZXRFcnJvcnMoZGF0YS5lcnJvcnMpO1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgc2VuZHMgYSByZWRpcmVjdCwgcmVsb2FkIHRoZSB3aW5kb3dcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5yZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBkYXRhLnJlZGlyZWN0O1xuICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZtLmZvcm0uc3VibWl0U3VjY2VzcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdm0uZm9ybS5zdWNjZXNzTWVzc2FnZSA9IGRhdGEuc3VjY2Vzc01lc3NhZ2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgc3RhdHVzVGV4dCkge1xuICAgICAgICAgICAgICAgIHZtLmZvcm0gPSB7Li4uZGVmYXVsdEZvcm1EYXRhfTtcbiAgICAgICAgICAgICAgICB2bS5mb3JtLnN1Ym1pdEVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2bS5mb3JtLnNlcnZlckVycm9yTWVzc2FnZSA9IGAke3hoci5zdGF0dXN9ICR7c3RhdHVzVGV4dH1gO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvLyBydW4gdGhlIHZ1ZS1mb3JtIGluaXQgc2NyaXB0IHByb3ZpZGVkIGluIHRoZSBPQyBhZG1pbiB1aVxuICBsZXQgaW5pdFNjcmlwdCA9IGFwcC5kYXRhc2V0LmluaXRTY3JpcHQ7XG4gIGlmIChpbml0U2NyaXB0KSB7XG4gICAgY29uc3QgaW5pdEZuID0gbmV3IEZ1bmN0aW9uKGRlY29kZVVuaWNvZGUoaW5pdFNjcmlwdCkpO1xuICAgIGluaXRGbigpO1xuICB9XG59XG5cbi8vIGxvb2sgZm9yIGFsbCB2dWUgZm9ybXMgd2hlbiB0aGlzIHNjcmlwdCBpcyBsb2FkZWQgYW5kIGluaXRpYWxpemUgdGhlbVxuZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi52dWUtZm9ybVwiKS5mb3JFYWNoKGluaXRGb3JtKTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oZXZlbnQpIHsgXG4gIGNvbnN0IGZvcm1Mb2FkZWRFdmVudCA9IG5ldyBFdmVudCgndnVlLWZvcm0tY29tcG9uZW50LWxvYWRlZCcpO1xuICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KGZvcm1Mb2FkZWRFdmVudCk7XG59KTtcbiBcbiJdfQ==
